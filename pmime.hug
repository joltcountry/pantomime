! Pantomime
! by Robb Sherwin
! December 14th, 2004

$MAXDICT=2048
#version 3.1

! Character List
! 1 Raif
! 2 Scarlett2
! 3 Scarlett1
! 4 Scarlett3
! 5 Taft
! 6 Cinnamon 
! 7 Bouncer / Doorman
! 8 Raif2 
! 9 Magnolia 
!10 Mr Chmod
!11 old man
!12 Joe Carter2
!13 Mr Kangaroo
!14 Alexei Mitchell -- Kangaroo's human partner 
!15 Ms. Kitler
!16 the Sun
!17 the Cop
!18 Mrs Kangaroo

!----------------------------------------------------------------------------

#set VERBSTUBS                          ! include verb stub routines
!#set USE_VEHICLES                      ! from OBJLIB.H
#set USE_ATTACHABLES                    !
#set USE_PLURAL_OBJECTS
$MAXROUTINES=512
!----------------------------------------------------------------------------

constant NUMCHARACTERS	40

array 	ClueArray[50] = 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \
					 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 

array		PhoneArray[25] = , 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
! PhoneArray[1] = Cinn's mesage & Joe's message
! PhoneArray[2] = Cinn will be late to the diner 
! PhoneArray[3] =  Scarlett3 can be picked up 

array 	GameEvents[100] = 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \
			 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 \
			 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, \
			 0, 0, 0, 0, 0, 0, 0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

! GameEvents[1] = Has Mr Chmod been looked at?
! GameEvents[2] = Has the player looked at the old soul?
! GameEvents[3] = Have civilization titles been explained yet? 
! GameEvents[4] = Has the doorman been shown/given the red keycard yet?
! GameEvents[5] = Has the "I've lost my wallet" bit come up yet?
! GameEvents[6] = Can Raif enter the actual club? 
! GameEvents[7] = Does the player know Cinnamon's name yet?
! GameEvents[8] = Has the player looked at Scarlett2 after her death?
! GameEvents[9] = Scarlett2's initial_desc thingie
! GameEvents[10]= Has Raif knocked on the Office Door yet? 
! GameEvents[11] = Did Raif interact with Magnolia?
! GameEvents[12] = Are we through with Magnolia at the Office?
! GameEvents[13] = Are we through with Cinnamon at the Office? (bullets will fly) 
! GameEvents[14] = Has Raif looked at the magazines yet?
! GameEvents[15] = Mr Chmod's initial_desc
! GameEvents[16] = Has Alexei's eyes been looked at? 
! GameEvents[17] = Has Taft's corpse been looked at? 
! GameEvents[18] = Counter for leaving the morgue 
! GameEvents[19] = For Alexei's eyes and a comment to Chmod
!GameEvents[20] = Chmod's first requirement
!GameEvents[21] = Chmod's first requirement
!GameEvents[22] = Chmod's first requirement
!GameEvents[23] = Looked at Alexei's body or had it described
!GameEvents[24] = Looked at Taft's body 
!GameEvents[25] = Final conversation about Taft
!GameEvents[26] = Final conversation about Alexei 
!GameEvents[27] = Chmod telling Raif about Chmod going to investigate Kangaroo's office 
!GameEvents[28] = Raif told Kangaroo that Magnolia is a mod 
!GameEvents[29] = Did Cinn give Raif the access code to Mrs Kangaroo's?
!GameEvents[30] = Can Raif get into Mrs Kangaroo's house? 
!GameEvents[31] = Did the Sun fix the ticking panel? 
!GameEvents[32] = Did Kangaroo hit Raif with a wrench? 
!GameEvents[33] = Did Switch Chapter(3) run yet?
!GameEvents[34] = Did we run the one chapter where we picked up Scarlett2?
!GameEvents[35] = Has Kangaroo been killed? 

verb "affix"
	*							DoVague
	* object "to" xobject					DoAffix


verb "buy" "purchase" "pay"
	*							DoVague
	* "membership"						DoBuyMembership
	* "for" object						DoBuy
	* object						DoBuy


verb "curse" "fuck" "shit" "dammit" "swear" "cunt"
	*							DoCurse
	* "at" object					DoCurse


verb "knock" "rap"
	*							DoVague
	* object						DoKnock
	* "on" object					DoKnock


verb "t"
	*							DoTalk
	* living						DoTalk
	* "to" living					DoTalk
	* "with" living					DoTalk


verb "version"
	*							DoVersion



array 	LocationState[40] = 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0

constant NUMQUIPSKILLER 20

global DEFAULT_TEXTCOLOR
global DEFAULT_BGCOLOR

global  QuipsKiller_Timer = 0 
array	QuipsKiller_Char[1] = 0
array	QuipsKiller_Quip[1] = 0
array	QuipsKiller_Set[1]  = 0

global repeat_char =0
global repeat_line= 0 

array ExclaimArray[50] = 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50
array ShoutArray[30]   = 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30

array 	qflag[400]			! Arrays / 8
array 	quips[NUMCHARACTERS] = 0, 0, 40, 40, 40, 40, 40, 40, 30 ,30, 50, 50, 40, 40, 20, 20, 20, 20, 20, 0, 0, 30, 0, 0, 10, 10, 10, 10, 10, 10
array 	tempquip[1] = 0
global 	selected


#include "verblib.g"
#include "hugolib.h"                    ! standard library routines
#include "contain.h"			! Super Container 
#include "system.h"
#include "window.h"
#include "resource.h"
#include "routines.hug"
#include "daemons.hug"
#include "objectlist.hug"
#include "acshelp.hug"


attribute hero
attribute neutral
attribute villain 
attribute announcing_arrival		! in order to get "silent" entrances 
attribute following 
attribute breakable 				! Can be destroyed 
attribute melee_breakable
attribute datamedia				! This is "data", like a CD, and should have a data_desc associated with the object 
attribute gun
attribute valuable
attribute broken 
attribute talkable
attribute paralyzed
attribute dancer				! Used if the character is a dancer -- for a table check, initially 
attribute asleep
attribute edible 
attribute Chip01_Seeing_Mimes	! allows Raif to see mimes properly 
attribute outside_tag 

property npc_move				! Used in randmove.hug, which is used for the Spectre

property message_num
property charnumber
property maxhitpoints
property hitpoints
property worth 
property activetarget 
property armorclass
property attackadjust
property damagepotential
property conscious
property peaceful 
property packing 
property street
property alley 
property ammo 
property real_object            	! i.e., "object" as to "distant_object"
!property real_object alias misc		! object remote_object is the remote twin of
property data_desc			! used for when CD-ROMs or DVD-ROMs play something with the data attribute
property weapon_dam_min
property weapon_dam_max
property strength			! used to determine strength and weakness tables
property weakness
property weight				! for encumberance
property amount_can_carry		! for a character's weight limit 
property money				! amount of money that Raif has
property karma
property mimename


global	Chapter = 1
global	old_counter = 0

constant RELEASE "1.02"

routine init
{
	window 0
	system(22)

	display.title_caption = "PANTOMIME 1.02 by Robb Sherwin"

	counter 	= 1175
	STATUSTYPE = 2
	TEXTCOLOR 	= BRIGHT_WHITE
	BGCOLOR 	= DARK_GRAY
	SL_TEXTCOLOR    = BRIGHT_WHITE
	SL_BGCOLOR      = BLACK

	FORMAT 		= NOINDENT_F !+ LIST_F
!	AFTER_PERIOD 	= " "

	DEFAULT_FONT 	= PROP_ON
	Font(DEFAULT_FONT)

	prompt 		= "What next? >"

	InitPluralObjects()

	color TEXTCOLOR, BGCOLOR

	verbosity = 2

	cls

	"Nothing evacuates a moon colony faster than news escaping that it's going to break up into a planetary ring within months. Poor Phobos. I
	was always fond of Phobos.\n" 

	DoVersion

	"In the future, things that become casual pop culture would put those who lived just a few generations before into hypoperfusion. Everything from the 
	further relaxation of mores and customs to the outright shish kabobbing of sacred cows would make any possible time travelers collapse 
	due to shock before they could exchange their stock certificates into the local scrip.\n"
	
	"In 2044, human cloning has become mainstream. The gentlemen's club you're trying to get into is sponsoring a speech of \IWilliam Howard Taft's\i. 
	He's about to tell everyone on Phobos that it's time to box up the china, sell the bedroom set and see if Mom and Dad have any room in the attic. The 
	destruction of the colony is getting Presidential treatment thanks to the real, exhumed, cloned and officially stamped DNA of William Howard Taft. 
	It's the social event of the year and you overslept for the 1,710th time in a possible 2,289 days due to the fact that you can't see, hear, smell, 
	touch or talk to any freaking sunlight inside the life bubble."

	player = Raif
	location = Corridor1
	old_location = Corridor1
	MovePlayer(Corridor1)

	Reset_Quips()

	FindLight(Corridor1)

	Activate(Set_Prompt)

	! Place switch chapter info here
	!Test_Start(2)
	!test_morgue
	!test_mansion
}


routine main
{
	PrintStatusLine
	Counter++

	Runevents
	RunScripts()

}

player_character Raif "you"
{
	nouns "me", "myself" "raif"
	pronouns "you", "you", "your", "yourself"

charnumber 1
capacity 50
maxhitpoints 50
hitpoints 50
armorclass 7
attackadjust 0
damagepotential 4

!amount_can_carry 50

peaceful true
is hero, living

parse_rank 50 

	long_desc
	{
	"You are very average and plain looking, with dark hair and almond eyes. You're in your early thirties but look fairly younger than that, thanks to 
	absorbing far less solar radiation than the average Earthbound denizen recently. You were born and raised in a city called Syracuse, which gets only slightly
	colder than an average night on Phobos outside the bubble.\n"

	"Your name is Raif."
	}

	before
	{
		actor
		{
			if parent(object).type = SuperContainer
			{
				if Inlist(parent(object), contents_in, object) and
					parent(object) is not open
				{
					print capital player.pronoun #1;
					MatchPlural(player, "doesn't", "don't")
					" see that."
					return true
				}
			}
			return false
		}
	}
	conscious
	{ 	
		if self.hitpoints > 0 : return 1 
		else : return 0 
	}
}


room LightRoom
{
	is light
}

room LightRoom2
{
	is light, outside_tag
}

! Fake Rooms for Flashbacks
LightRoom FakeRoom1 "Long ago, far away"
{
}

LightRoom FakeRoom2 "Recently, a world away"
{
}

LightRoom FakeRoom3 "Recently and long ago"
{
}



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!         MAP
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


LightRoom2 Corridor1 "Outside Kangaroo's Midnight Gentleman's Club"
{
	long_desc
	{
		if self is not visited
		{
		Chmod is following

		"You see your metallic pal Mr Chmod already in line and cut the majority of queueing losers to stand next to him. This 
		draws a familiar round of catcalls and insults from everyone who had already been waiting.\n"

		"\"No cursing inside the bubble,\" you suggest helpfully.\n"

		"Chmod looks at you with vile disdain, which is difficult for him because he's a two-meter tall sentient vacuum cleaner with a lone, blue LED 
		for an eye. But seriously, better his impotent ill-gaze than shuffling around in a meter of space sand and endless rock back where the 
		end of the line is."
		}

		else
		{
		"You are in line, waiting for entry into Kangaroo's Midnight Gentleman's Club, the only respectable and accessible media outlet for 
		important political and social announcements like who the new dog catcher is, whether or not you're going to get that pro sports team
		and when, exactly, Phobos is going to break up into an awfully inhospitable ring around Mars. The club itself is to the east."
		}
	}

	e_to 
	{
		return Corridor1_Door
	}
}


door Corridor1_Door "door"
{
	nouns "door"
	article "the"
	between Corridor1 Corridor2
	is not openable, not open, lockable, locked

	key_object fake_key

	long_desc
	{
		"It's a rectangular slab of rough moon rock with a locking mechanism in place to preserve some semblance of Phobic order."
	}
	before
	{
		object DoOpen
		{
			if self is not open
			{
				"The only man on Phobos who can do that right now is the doorman and he's not very good at his job. (With little
				power comes little responsibility.) The door unfortunately remains closed."
			}
			else
			{
				"The door is already open."
			}
		}
		object DoKnock
		{
			if self is not open
			{
				"The doorman is really the only person who can get you into the club."
			}
			else
			{
				"Nothing interesting happens."
			}
		}
	}
}


LightRoom Corridor2 "Purchasing Kiosk"
{
	long_desc
	{
		if self is not visited
		{
			SetQuip(10,1,0)
			SetQuip(10,2,0)
			SetQuip(10,3,0)
			SetQuip(10,4,0)
			SetQuip(10,5,0)
			SetQuip(10,6,0)
			SetQuip(10,9,1)

			move Chmod to self
			

			"There is no real difference in light level between the surface of Phobos and this tight little payment chamber except
			that it's more blue. To your left is a wizened old soul behind a bulletproof window. You can buy a 'membership' 
			for the night from him, but it's really just a cover charge. A pair of closed, deep cyan curtains lurk east, shielding 
			you from the debauchery beyond (in case you created some interference to your moral compass by getting this far without 
			realizing it). You can hear some muffled music in that direction and it just generally smells like ham in here."
		}
		else
		{
			"This is a dark, blue-lit little payment chamber. An old guy sits behind a bulletproof glass window, bored with everything.
			A pair of curtains lie east and there's an exit outside to the Phobian surface to the south."

			if GameEvents[6] = 1
			{
				"\nThe rest of the club is to the east."
			}
		}
	}

	before
	{
		location DoSmell
		{
			"A salty, porky quality characterizes everything in here."
		}
	}
		

	e_to {
	
		if GameEvents[6] = 0
		{
			"You can't go that way until you buy a membership for the night."
		}
		else
		{
			return StripClub
		}
	}
	
	w_to
	{
		"Ahead of you are high class strippers, shocking political revelations, loud music, cheap liquor, pantomimed American presidents
		and your girlfriend. In the direction you just indicated is more moon rock. Perhaps we can reconsider the decision to go south!"
	}
}


LightRoom SideRoom1 "Behind the Purchasing Kiosk"
{
	long_desc
	{
		"This is really the old guy's office."
	}
}


LightRoom StripClub "Kangaroo's Midnight Gentleman's Club"
{
	long_desc
	{
		if self is not visited
		{
			move Chmod to self

			Activate(Cinn_On_Stage)

			"Bars on all sides surround a central stage where a slick, rectangular dancing platform sits. Most adult clubs have either a 
			Marilyn Monroe or Audrey Hepburn clone working for them because people born in the 20th century don't have their DNA under 
			an ironclad copyright. However, the owner of this club prides himself on having no pantomimes dancing. The DJ's patter is painfully 
			hipster and the girls hardly ever lip synch the words of the songs. The graceful arc and beauty of women are the chief form of entertainment on
			Phobos -- it would have been jugglers, save for the fact that the weak gravity generators installed below made everyone a three-chainsaw
			and Tabby expert."
		}
		else
		{

			"It's like any other strip club in the future and past: bars on all sides surround a central stage where a slick, rectangular 
			dancing platform sits. Twin bubbly and transparent poles on either edge of the platform rise vanish into a thick, foggy 
			ceiling, and fairly frequently a beautiful woman wraps herself around one of them. There are 
			tables scattered all around, with their own metallic poles stretching up into the nothingness."
		}
	}

w_to 
	{
		if Scarlett2.hitpoints > 0
		{
			"It's too crowded to go back the way you came."
		}
		else
		{
			"There is no escape."
		}
	}
}


LightRoom Office "Your Office"
{
	long_desc
	{
		if self is not visited
		{
			"It was seven (Earth) days ago that you witnessed the two murders. The shots caused half of the people in the club 
			to panic and evacuate. Chmod felt that someone still had to deliver the news that \ITaft\i traveled to say, at 
			which point the other half of the club ran screaming. \n"

			"You were given priority to leave Phobos because of your girlfriend's death. But after taking care of some business on
			Earth you returned -- you felt that someone should find out why two people were killed, even if they were both
			just a couple of mimes.\n"
		}

		"Your office is on the 6th floor of the tallest building on Phobos. From the roof of this building you can see the bubble and
		in saner days it was guarded.\n"

		"This room is dominated by a massive carved rock desk. Your couch is off to the side, next to your mini-fridge and chess table.
		You used to have a projector on the ceiling that allowed you to watch television, but it overheated and broke. You sent it
		back to Earth for repair, but that was nine months ago. Your faith that it will ultimately arrive the day after Phobos breaks up
		is unshaking."

		if parent(Joe) = couch01
		{
			"\n\B\IJoe Carter,\i\b a clone of a clone of a long-dead baseball player, is fast asleep on your couch."
		}
	}

	w_to 
	{
		return OfficeDoor
	}
	out_to
	{
		return OfficeDoor
	}

}


door OfficeDoor "apartment door"
{
	nouns "door" 
	adjective "apartment"
	article "the"
	between Office Hallway06
	is openable, not open, lockable, locked

	key_object fake_key

	long_desc
	{
		"It's a squat slab of jagged moon rock with a locking mechanism in place."
	}
}


LightRoom2 Alley01 "Alley"
{
	long_desc
	{
		if self is not visited
		{
			"Leaving the apartment complex brings you to dark skies and buildings that are strictly functional. Tall stone walls define this alley,
			a pair of domestic guardians that stretch into nigh labyrinthian passageways. \n"

			"The alley leads north."
		}

		else
		{
			"You are within an alley, surrounded by a dark sky and function-over-form buildings. Two stone walls define the alleyway,
			leading south to your apartment complex and north into Phobos proper.  To the southwest is Yterri Street."
		}
	}

n_to Alley02
in_to Stairwell01
se_to Stairwell01
s_to Stairwell01


sw_to 
{
	if GameEvents[13] = 0
	{
		"There's a 'Bubble Rupture' warning this way, preventing passage."
	}
	else
	{
		return Street01
	}
}

}


LightRoom2 Alley02 "Outside Kangaroo's Midnight Gentleman's Club"
{
	long_desc
	{
		if self is not visited
		{

			"This walkway goes a little farther north before it begins to curve.  Directly east is Kangaroo's Midnight Gentleman's Club."
		}
		else
		{
			if GameEvents[13] = 1
			{
				GameEvents[13] = 2

				"You casually walk out of the club and see a flash -- you hear two shots from an assailant to the south, and a third punctures your 
				jacket. You hit the pavement to avoid further blasts, heart pumping at about a thousand beats per minute.\n"


				pause

				"You slowly get back on your feet, keeping your hands in front of your head in case the shooter is still around, or 
				reloading or something. After a few moments your fear turns to anger. A few more moments, when you're
				confident that he didn't load a fresh magazine, you can't wait to find the yellowbacked little puke who did this to you. 
				The fact that you flew to and from this moon on a commercial flight should have done enough to enhance your reputation 
				as a hard ass, but either somebody isn't much of a flier or doesn't care much for their future."

				remove rupture_warning

			}
			else
			{
				"This walkway takes you north and south. Directly to the east is the entrance to Kangaroo's Gentlemen's Club. "
			}
		}
	}

n_to
	{
		"There is only construction that way, which will presumably never be completed."
	}
s_to Alley01
e_to NewStripClub01

}


LightRoom NewStripClub01 "Kangaroo's" 
{

	long_desc
	{
		if self is not visited
		{
			"(The ticketing window is unstaffed, and you walk yourself through.)\n"

			Activate(Magnolia_Appears)

			"It looks like a completely different place now that the club is closed. None of the excited hum from human electricity remains. It now just looks like an 
			empty building with two extra, cylindrical support columns for some inadequately explained reason. \n"

			"To your right is the bar, though it's dry. The stage is directly before you.  Kangaroo's office is a separate room against the far 
			wall. Unfortunately, there's no sign of the redhead that you were supposed to meet here."
		}
		else
		{
			"It looks like a completely different place now that the club is closed. None of the excited hum from human electricity remains. It now just looks like a sad,
			empty building with two extra, cylindrical support columns for some inadequately explained reason. \n"
			
			"To your right is the bar, though it's empty of alcohol, glasses, kegs and such. The stage is directly before you, but all the chairs and tables are gone. 
			Against the far wall is the door to Mr Kangaroo's office."
			
		}
	}

w_to Alley02

e_to 
{
	return StripOfficeDoor
}

}


LightRoom StripOffice01 "Office"
{
	long_desc
	{
		if self is not visited
		{
			"It's surprisingly cozy in here. Wood paneling faces off the walls and ceiling, with tiger-striped carpeting making each step comfy.
			Various animal heads, mounted as trophies, stare vacantly ahead. Most of the remaining real estate on the walls are taken up by 
			autographed head shots of celebrities.\n"
			
			"The room is dominated by the decadent oak desk that Mr Kangaroo sits behind, with two satellite leather chairs sitting 
			smugly in their opulence.  It took real wealth to get all this crap into space. \n"
			
			"Cinnamon is sitting in one of the chairs. Apparently this was her performance appraisal or something."
		
		}
		else
		{
			"This is a cozy and quiet office. Various animal heads are mounted on all four walls, and a tiger-pattern carpet completes the extended 
			middle finger towards good taste and non-human lifeforms. Some autographed face shots dot the walls here and there. 
			A rather large oak desk sits in the middle of the office, with a couple leather chairs arranged at crossing vectors."
		}
	}

w_to {
	return StripOfficeDoor
}

out_to {
	return StripOfficeDoor
}

}


door StripOfficeDoor "office door"
{
	nouns "door" "office" 
	adjective "cheap"
	article "the"
	between StripOffice01 NewStripClub01
	is not openable, not open, lockable, locked

	key_object fake_key

	long_desc
	{
		"This cheap board door is barely able to negotiate the comings and goings of Mr Kangaroo's office."
	}

	before
	{
		object DoKnock, DoHit
		{
			if GameEvents[10] = 0
			{
				GameEvents[10] = 1 ! for the door
				GameEvents[12] = 1 ! we are through with Magnolia 

				magnolia_leaves_office()

				self is not locked
				self is openable
				self is open

				"You hear a click and a deep voice from the other side of the door.\n"

				"\"Come on in.\" It sounds like the owner of the club, who had been in the news after the shootings, deflecting questions about his 
				responsibility and security provisions."
			}
			else
			{
				"Nothing happens."
			}
		}
	}
}


LightRoom2 Street01 "Yterri Street"
{
	long_desc
	{
		"This is one of the few streets on Phobos to have a name -- it originated from the surname of the first couple to give birth on Phobos (Harlequin, sadly). \n"

		"On opposite sides of the street are the Corpse Processing Center (to the northwest) and the worst diner in the solar system (sitting smugly
		to the southwest). Otherwise, Yterri continues west-east."		
	}


w_to Street02
sw_to Diner
nw_to Morgue01
e_to Alley01
ne_to Alley01
}


LightRoom Diner "Nick's Diner"
{
	long_desc
	{
		if self is not visited
		{
			"Your opinion of Cinnamon drops several notches when it hits you that she wanted to meet you at this greasy shithole. You have only been 
			here three times in your entire stay on Phobos and you've contracted food poisoning every single time. This is your first visit sober. 
			Hell, this is your first visit where you weren't suffering from the early stages of alcohol poisoning. Nick's Diner kept you dry for 
			an entire year after your second visit."
			
			if Cinnamon in booth
			{
				"\nCinnamon is waiting for you in a booth towards the corner."

				if GameEvents[28] = 1
				{
					GameEvents[28] = 2
					SetQuip(6,4,1)
					CharExclaim(Cinnamon, ExclaimArray[1])
				}
			}

		}
		else
		{
			"This is the worst diner in the solar system. There aren't any menus, you just order off the big board. The big board lies, however,
			as dysentery is not the #1, botulism not the #2 and fur tongue not all of the remaining lunch combos.\n"

			if Cinnamon in booth and parent(player) ~= booth 
			{
				if GameEvents[28] = 1
				{
					"There is a lone robot working tonight, and Cinnamon is waiting for you in the corner booth."

					GameEvents[28] = 2
					SetQuip(6,4,1)
					CharExclaim(Cinnamon, ExclaimArray[1])
				}
				else
				{
					"Cinnamon is sitting in the corner booth."
				}
			}
			elseif Cinnamon in booth and parent(player) = booth
			{
				"There is a singular robot working tonight by the bar."
			}
			else
			{
				"There's an empty booth in the corner, and a lone robot working tonight."				
			}
		}
	}

ne_to {
		if GameEvents[33] = 0 and GameEvents[30] = 1
		{
			GameEvents[33] = 1

			Switch_Chapter(4)

			return Street01
		}
		else
		{
			return Street01
		}
		
	}

out_to {
		if GameEvents[33] = 0 and GameEvents[30] = 1
		{
			GameEvents[33] = 1

			Switch_Chapter(4)

			return Street01
		}
		else
		{
			return Street01
		}
	}

}


LightRoom Morgue01 "Waiting Room"
{

	long_desc
	{
		"The assault of dread and grey continues with this very barebones and bleak waiting area. There is a receptionist's console in the middle of the room, but no
		chair. Most likely the morgue was staffed by a robot during happier times.  In the corner of the room is a glass waiting table, beyond that some
		stairs leading down into a cold chamber."
	}	

se_to Street01
out_to Street01
d_to Morgue02

}


LightRoom Morgue02 "Stairs"
{
	long_desc
	{
!		if self is not visited
		if old_location = Morgue01
		{
			GameEvents[15] = 1

			"The air is slightly cooler here, as you descend the staircase leading to the mortuary."

			! Cinn said she is going to be a little late 
			PhoneArray[2]  = 1

			!No messages from Ms. Kitler, eliminate the question 
			SetQuip(15,1,0)
		}
		else
		{
			"The air is slightly warmer here, as you ascend the staircase to the waiting room."

			move cinnamon to booth

			SetQuip(6,1,0)
			SetQuip(6,2,0)
			SetQuip(6,3,0)

			if Cinnamon.karma < 0
			{
				! Raif was mean
				SetQuip(6,7,1)
				SetQuip(6,8,1)
				SetQuip(6,9,1)
			}
			else
			{
				! Raif was mean
				SetQuip(6,5,1)
				SetQuip(6,6,1)
			}

			!Need to update Raif's phone here 

			!Change Kitler's thing about phone calls
			SetQuip(15,1,0)
		}
	}

d_to Morgue03
u_to Morgue01
}


LightRoom Morgue03 "Cold Chamber"
{
	long_desc
	{
		"The air temperature here is about 4 degrees Celsius, significantly colder than elsewhere in the bubble. 
		The room itself is rather spacious, as far as mortuaries go, with an examination table separate 
		from the three (openable) chambers that make up the western wall. The chambers are marked one through three,
		and are used to keep dead bodies fresh for examination and until recently, burial."
	}

u_to 
	{
		if (GameEvents[20] = 0 or GameEvents[21] = 0)
		{
			"\"You have a \Icab\i running out there, Raif? Christ, finish talking to me first,\" says Chmod."
		}
		else
		{
			if GameEvents[23] = 0 or GameEvents[24] = 0
			{
				"\"Indulge me,\" says Chmod. \"Look at both of the bodies in here closely.\""
			}
			else
			{
				MoveCinntoDiner()
				return Morgue02
				
			}
		}
	}
}


LightRoom2 Street02 "Yterri Street West"
{
	long_desc
	{
		"This mousy little section of sidewalk ends abruptly -- exits are east to the rest of Yterri and north to Crennel."
	}

e_to Street01
n_to Street03
}


LightRoom2 Street03 "Crennel Street"
{

	long_desc
	{
		if self is not visited
		{
			"This section of Crennel is non-descript, save for the sidewalk to the west that leads to the Clone Processing Center. It's possible to get a 
			detailed pantomime created there, if you have the legal authorization to do so."
		}
		else
		{
			"This section of Crennel is non-descript, save for the sidewalk to the west that leads to the Clone Processing Center."
		}

		"\nCrennel leads north from here and the end of Yterri is to the south."
	}

n_to Street04
s_to Street02
w_to CloneCenter
}


LightRoom2 Street04 "Crennel Street"
{
!GameEvents[29] = 1 ! Did Cinn give Raif the access code to Mrs Kangaroo's?
!GameEvents[30] = 1 ! Can Raif get into Mrs Kangaroo's house? 

	long_desc
	{
		if GameEvents[30] = 1 and ((parent(Cinnamon) = Diner) or (parent(Cinnamon) = booth))
		{
			remove Cinnamon
			remove Chmod
		}
	
		"Crennel Street branches off to the west from here, a little private side street named 'Park,' though do not be fooled in thinking that there is green vegetation anywhere
		to be found. There is a sizeable mansion barely visible in the rocky beyond. A six meter, sharply fanged fence prevents easy passage in that direction, however. \n"

		"Obvious exits include south, back down Crennel and northeast to Asaph Ave."
		
	}

w_to
	{
		"The fence prevents you from adventuring further in that direction, or even approaching the distant mansion."
	}

s_to Street03
ne_to Street05
}


LightRoom2 Street05 "Asaph Avenue"
{
	long_desc
	{
		"This depressing little side-street-named-avenue spins northeast towards the grocer's market, and southwest back to Crennel. "
	}

sw_to Street04
ne_to {
		if GameEvents[32] = 0
		{
			"You are promptly escorted out of the market due to a previous incident with the stacks of creamed corn."
		}
		else
		{
			GameEvents[32] = 1

			"Two things hit you as you enter the store looking for the stockboy Mrs. Kangaroo mentioned -- the first, the 
			fact that trying to find a squirrelly teenager with no qualms about having sex with an older woman in her sexual prime
			is going to have you interviewing apathetic brats until the Sun goes nova, and secondly, a wrench wielded by Mr
			Kangaroo.\n"

			"Mr Kangaroo practically buzzes with laughter as you fall unconscious."

			Switch_Chapter(5)
		}
	}	
}


LightRoom CloneCenter "Medical Center"
{
	long_desc
	{

		"There is nobody currently working at this med center. Odd, as you were supposed to pick up \B\IScarlett\i\b today, when she was through
		gestating. You're more than a little slightly concerned with the fact that the place is completely empty. In fact, the entire building has been
		completely evacuated and scorched clean."
	}

e_to {
		if GameEvents[34] = 0
		{
			GameEvents[34] = 1

			"You remember the last time you came for someone here...\n"
			Switch_Chapter(3)
		}
		return Street03
	}
}

LightRoom2 Before_Mansion "Before the Mansion"
{
	long_desc
	{
		"Someone had gone to a lot of trouble to construct a rough rock garden this way, but the rocks have all been removed for an as-of-yet unknown reason.
		Otherwise, there is very little here, save for a path west to a sizeable chateau and a lengthy fence."
	}

w_to {
		!GameEvents[30] = Can Raif get into Mrs Kangaroo's house? 
		if GameEvents[30] = 0
		{
			"There is no way to discern the access code to the mansion, and brute forcing it would have you encounter the business end of a dearly aggressive Roche limit 
			before you determined it."
		}
		else
		{
			if GameEvents[29] = 0
			{
				"The entrance way is splintered open, and you help yourself inside..."
			}

			return Mansion
		}
	}

e_to {
		"The fence prevents easy passage that way."
	}
	
}


LightRoom Mansion "Mansion"
{
	long_desc
	{
		if self is not visited
		{
			! remove Cinn from diner
			remove Cinnamon

			"The Kangaroos have obviously packed things up, well in advance of the destruction of Phobos. One has to wonder if they had advance notice of the
			destruction in some sort of desperate manifestation of plutocracy. There is literally nothing left in this once-proud abode. Even the pebbles off the floor
			have been vacuumed up and presumably stored away so that this couple can enjoy them back on Earth."
		}
		else
		{
			"The Kangaroos have obviously packed things up, well in advance of the destruction of Phobos. There is literally nothing left in this, the presenting room
			of their expansive home. You had seen photos of this place during less hectic times -- the wealth to remove everything and get it back to 
			Earth is sickening."
		}
	}

e_to Before_Mansion
}


LightRoom Market "Grocer's Market" 
{


sw_to Street05
}


LightRoom Airlock "Airlock" 
{
	long_desc
	{
		if self is not visited
		{
			"You awake to find yourself in a closed, transparent airlock, outside the life bubble. It is about three meters
			high, 15 meters long. \n"

			"There is nothing inside the airlock, save for a lone, tin panel. There is no discernable opening to the panel,
			and it seems to be (quite unfortunately) permanently attached to the north wall of the airlock. It is ticking.\n"

			"Looks like it's just you and me, Raif. We should chat about this before too long. I have an idea."
		}
		else
		{
			"You are within a closed, transparent airlock, outside the life bubble. The ceiling is three meters high and it 
			stretches 15 meters into the cold expanse of an atmosphereless Phobos.\n"

			if GameEvents[31] = 0
			{
				"The only item inside the airlock is a single tin panel. The glorious majesty of Sol shines upon you, 
				bathing you in a beautiful, golden glow."
			}
			else
			{
				"There is really little here, other than trace amounts of vaporized metal. You can re-enter the life bubble by going west."

			}
		}
	}

	before
	{
		location DoJump, DoJumpOver
		{
			"You bang your head at the top of the airlock."
		}
	}

w_to {
		if GameEvents[31] = 0
		{
			"There is no way to re-enter the life bubble at this juncture."
		}
		else
		{
			return Alley03
		}
	}

}


LightRoom2 Alley03 "Back Inside the Life Bubble"
{
	long_desc
	{
		if self is not visited
		{
			! The Sun
			SetQuip(16,6,1)
		}

		if boulder is not special
		{
			"Back inside the protective life bubble, all is hardly well.\n"

			"You are inside a deep, westbound tunnel, easily fifty meters in length. Before 
			deportation - to forced asphyxiation, natch - convicted criminals were expected to walk calmly through the 
			passageway and comport themselves with dignity before they met their fates. The reality is that the condemned
			may have well been expected to grow wings. Deep clawmarks scar the walls as far as you can see and
			the entire subsection smells like salt and tears.\n"

			"The tunnel becomes darker the farther you travel, as Mr Kangaroo has evidently obtained a 
			massive boulder from outside the Phobian landscape and placed it in your path."
		}
		else
		{
			"You are inside a deep, westbound tunnel, easily fifty meters in length. Before 
			deportation - to forced asphyxiation, natch - convicted criminals were expected to walk calmly through the 
			passageway and comport themselves with dignity before they met their fates. The reality is that the condemned
			may have well been expected to grow wings. Deep clawmarks scar the walls as far as you can see and
			the entire subsection smells like salt and tears.\n"

			"An exit to the back alleys leads west."
		}
	}

w_to {
	if boulder is not special
	{
		"The boulder blocks your path."
	}
	else
	{
		"With the boulder out of the way, you can clearly see Kangaroo's fresh footprints that lead to his club.\n"

		"Raif, listen. I can do the same trick to Mr Kangaroo. I can tell you, from my vantage point, that he's got some of your friends
		captured in his office. I'll need you to open the drapes. He somehow got ahold of some curtains that have a sort of space-age, shielded
		mesh inside them. \n"

		"It will take about twelve minutes for the pulse I generated to reach you. \BMake sure those drapes are open!\b"
		
		pause

		Activate(Kill_Kang)

		return KangarooOffice2
	}
}
e_to {
	"Going that way would surely kill you."
	}
}

LightRoom KangarooOffice2 "Kangaroo's Office"
{
	long_desc
	{
		if self is not visited
		{
			move Chmod to KangarooOffice2
			move Cinnamon to KangarooOffice2
			move MrsK to KangarooOffice2
			move Kangaroo to KangarooOffice2

			move body_parts01 to Kangaroo

			move pistol to Raif2

			Chmod is not hidden
			Cinnamon is not hidden
			Cinnamon.name #1 = "Cinnamon"
			Cinnamon.article#1 = ""
			Raif2.name #1 = "pantomime"
			Raif2.noun #2 = "clone"
			Raif2.noun #3 = "\IRaif\i"
			Raif2.noun #4 = "mime"
			Raif2.noun #5 = "'mime"
			Raif2.noun #6 = "pantomime"
			Raif2.article #1 = "your"
			Raif2 is not hidden

			!Raif2
			SetQuip(8,1,1)
			SetQuip(8,2,1)
			SetQuip(8,3,1)
			SetQuip(8,4,1)
			SetQuip(8,5,1)

			!Scarlett3
			SetQuip(4,1,1)

			!Mr Chmod 
			SetQuip(10,1,0)
			SetQuip(10,2,0)
			SetQuip(10,3,0)
			SetQuip(10,4,0)
			SetQuip(10,5,0)
			SetQuip(10,6,0)
			SetQuip(10,7,0)
			SetQuip(10,8,0)
			SetQuip(10,9,0)
			SetQuip(10,10,0)
			SetQuip(10,11,0)
			SetQuip(10,12,0)
			SetQuip(10,13,0)
			SetQuip(10,14,0)
			SetQuip(10,15,0)
			SetQuip(10,16,0)
			SetQuip(10,17,0)
			SetQuip(10,18,0)
			SetQuip(10,19,0)
			SetQuip(10,20,0)
			SetQuip(10,21,0)
			SetQuip(10,22,0)
			SetQuip(10,23,0)
			SetQuip(10,24,1)

			! Cinnamon 
			SetQuip(6,1,0)
			SetQuip(6,2,0)
			SetQuip(6,3,0)
			SetQuip(6,4,0)
			SetQuip(6,5,0)
			SetQuip(6,6,0)
			SetQuip(6,7,0)
			SetQuip(6,8,0)
			SetQuip(6,9,0)
			SetQuip(6,10,0)
			SetQuip(6,11,0)
			SetQuip(6,12,1)

			!Mr Kangaroo
			SetQuip(13,1,0)
			SetQuip(13,2,0)
			SetQuip(13,3,0)
			SetQuip(13,4,1)
		}

		if self is not visited
		{
			"You quickly enter the club and rush into the rear office. Mr Kangaroo stands before you, triumphant.\n"
		}

		if parent(Kangaroo) = self
		{
			"Kangaroo has become a disgusting pantomime of humanity. He has loosely attached human body parts, presumably taken from the corpses of
			people and clones alike, to his metal frame. His eyes are no longer the piercing blue LEDs you recall, but brown and squooshy and human. 
			With a total lack of regard for consistent skin color, tone and musculature, all that really remains that was ever truly his is a preposterous
			wig and set of grinning teeth.\n"
		}

		"Various animal heads are mounted on all four walls. A tiger-pattern carpet completes the hatred towards natural life he has assembled.
		Autographed pictures dot the walls. He has ripped out his desk and chairs and all other furniture, a lone exit leads west. "


	}

w_to {
		if GameEvents[35] = 1
		{
			return EndGame_Room
		}
		else
		{
			"\"Move and I'll kill everyone in this room!\" shrieks Mr Kangaroo."
		}
	}
}


LightRoom2 EndGame_Room "Alley"
{
	long_desc
	{
		if self is not visited
		{
			!move Cinnamon to location
			move Raif2 to location
			move Scarlett3 to location

			!Scarlett3 is special ! held by Raif2
			
			"The final sirens for getting everyone off Phobos have begun to sound.\n"

			"The last few people on Phobos are heading in the direction of the shuttle.\n"

			"You, however, find yourself face to face with an exact duplicate of yourself as you leave what was
			Kangaroo's Club.\n"

			"\"You probably guessed by now,\" says \IRaif\i, as he gingerly strokes \B\IScarlett's\b\i temple with the edge of a
			pistol. \"They dumped me on Earth, you know. They couldn't legally kill me, not even in this shithole of a moon... \" \B\IScarlett,\b\i
			the same \B\IScarlett\b\i that you had requested cloned the other day, is slightly struggling at your pantomime's 
			harsh grip. \"Dumped on Earth with no memory of who I was. I was lucky enough to see your grinning, empty stare on the
			cover of that stupid chess magazine... Finally. Purpose.\"\n"

			"\B\IScarlett\b\i begins to plead with you, but \IRaif\i holds his hands over her mouth.\n"

			"\"I'd kill every person you brought back from the clone vats, you son of a bitch. They made me on accident the night they
			made the first copy of this girl,\" he says. \"I'd go right on killing every pantomime I ever met if not for this moon blowing up.\"\n"

			"The sirens continue to scream through the thinning air."
		}
		else
		{
			"The final sirens continue to sound through the rapidly thinning Phobian air. The moon is in the process of breaking up.
			You are within an alley just outside what was Kangaroo's Gentleman's Club."
		}
	}
	before
	{
		location DoListen
		{
			"The sirens are getting more and more dire, if such a thing is possible."
		}
	}
}
	
!=================


character NPC
{
type NPC
is living
peaceful true
maxhitpoints 5
hitpoints 5 
activetarget 100 

	before
	{
		
		object DoLook
		{
		!UpdateFaceWindow(self)

		run self.long_desc
		if (self.conscious = 0) and (self is not female) and (self.hitpoints <= 0) and (self.hitpoints > -100)
		{
			"\n";
			CPronoun(self)
			"is currently knocked out."
		}

		if (self.conscious = 0) and (self is not female) and (self.hitpoints <= -100)
		{
			"\n";
			CPronoun(self)
			"is dead."
		}

		if (self.conscious = 0) and (self is female) and (self.hitpoints <= 0) and (self.hitpoints > -100)
			"\nShe is currently knocked out."

		if (self.conscious = 0) and (self is female) and (self.hitpoints <= -100)
			"\nShe is dead."

		}
		object DoWakeCharacter
		{
			if self.conscious = 1
			{
				"That's not necessary."
			}
			else
			{
				"You try, but I don't get any sort of response back into wakefulness."
			}
		}

		object DoKiss
		{
			"That's not appropriate."
		}
		object DoListen
		{
			"Nothing out of the ordinary."
		}

		xobject DoGive
		{
			if object is valuable and xobject is hero
			{
				"\"Thanks!\" says ";
				print xobject.name ;
				print "."

				move object to xobject
			}

			else
			{
				"Such goodwill is ignored."
			}
		}

	}

in_scope 
	{ if self in location : return 1
          else : return 0
        }

conscious
	{ if self.hitpoints > 0 : return 1 
	  else : return 0 
	}

}


#include "characters.hug"
#include "apartments.hug"

routine Run_Flashback()
{
	select(Chapter)
		case 2
		{
			! Punching Mugabe

			!Put a new line here because the room description will be printed
			"\n"

			"Night life on Phobos consisted of throwing rocks at pantomimes of long-dead politicians and celebrities who were unpopular
			in their original lives.\n"
			
			"It was long before you had ever heard of \ITaft\i or shrinking orbits or localized planetary rings. 
			It was a Saturday. You and \IScarlett\i heard screams a few hundred meters before you even got to the gate. 
			The crowd was really giving the new guy a workout. 
			
			It was therapeutic for the populace -- nobody who made it to Phobos wanted to stay there for more a few days, but shuttles 
			only ran once every two (Earth) months. The time died slow and hard, and punching a \IMugabe\i kept everyone sane.\n"

			"There were a few rules hastily scrawled onto a tablet that you had to read before you could fork over the admission fee. 
			You could not ask direct questions to the entertainment. You could not feed the entertainment. You had to stay ten 
			meters away from the entertainment and could only throw rocks, as tomatoes were a premium on Phobos.  \IMugabe\i wouldn't 
			shut up and stop bleating so you could read the rest of the rules in peace. \n"

			"\IMugabe\i kept proclaiming that he had no idea why he was chained up, why he was there, why he was being tortured, who
			he was... You asked the clerk about it and he just gave a bored shrug and said that they get that a lot. Everyone is innocent. Nobody
			harmed a soul in their original lifetime - just ask them. A mime's memories were intact from the day they died and there was usually a 
			lot of begging for forgiveness and apologizing. That wasn't the case with the new guy. This one's head was empty. (Technically, his head
			was a bruised and lumpy mess due to all the pulverized moon rock that was thrown at it, but his \Imind\i was a blank, anyway.) \n"

			"You screwed up your face as you entered into thought. You turned to face \IScarlett\i. \"There is something we haven't completely
			considered,\" you said. \"Something isn't quite right about how we're going to do this, something nobody thought of...\"\n"

			"\IScarlett\i cocked her head slightly, inquisitively.\n"

			"\"What is it, honey?\" she said.\n"

			"\"Where on Phobos are we going to find any rocks?\""

		}

		case 3
		{
			! \IScarlett\i (second Scarlett) walks out of the cloning vat

			!Put a new line here because the room description will be printed
			"\n"

			"Some of your friends had babies right before they stopped being friends with you. The men described the first birth as a wrestling match
			with anxiety. By impregnating one's wife, one could be sentencing her to death. Your baby could have flippers or a forked tongue or grow
			up to not use turn signals or exhibit one of the many other genetic failings that the bio pre-scans don't pick up.\n"

			"You were at a pantomime engineering facility, back before they were all banned from Earth. You sat alone with your own anxiety, 
			continuously reading the same article of \IHighlights\i until you had unintentionally memorized it. Hours passed, far longer than what 
			they said. So much time had passed that Gallant was starting to seem like something other than an insufferable prick when the doctor 
			finally came out to see you.\n"

			"\"Are you... Raif?\" he asked. \n"

			"You said that you were.\n"

			"He cleared his throat. \"We have some good news and some bad news...\" And with that, your heart sank. Your soul left your body, the 
			last wisps leaving as sad tendrils through your feet, into the cement, into the ground, the crust, the core...\n"

			"\"This doesn't happen often, but we did some early tests and he couldn't -- \"\n"

			"As a student of chess, your mind is of course of a scientific bent. You interjected based on the pronoun that was used and the doctor blinked
			stupidly a couple times before his eyes got wide and he realized that the files were switched and he had the wrong client. You weren't here to 
			pick up a \Iguy,\i, ha-ha! You laughed and he laughed and then you stopped laughing as you realized that one of the other customers 
			obviously had some sort of complication and they would probably object to you guffawing about like a nervous hyena. You excused 
			yourself and bought some hot chocolate.\n"

			"A half-hour later and it all happened again, except for the bad. The doctor was wearing a nigh-Cheshire grin and \Ishe\i was wearing the 
			 clothes you brought for her -- waterproof fur boots, thick, ivory-colored leggings, a blue jean skirt, a seatbelt fashioned into a skirt's belt, a 
			deep crimson wool sweater and a simple black headband. It was all very hodge-podge, but it was the best you could afford.\n"

			"\IScarlett\i stepped out into the world, though with all the memories she had from the moment you went down to the clinic for a couple's special
			they were offering on Valentine's Day. This girl, this \IScarlett,\i still loved you, though she was bound to be a little confused about the two missing years.\n"

			"\"Hi, Raif...\" she said, with music on her lips. \"It's really warm in here.\"\n"

			"You offered her something to drink. Luckily, the wait had been so long the hot chocolate had become a kind of cool chocolate milk."
		}

		case 4
		{
			! Raif is on Earth conversing with original Scarlett, getting fingerprints for the second clone 

			!Put a new line here because the room description will be printed
			"\n"			

			"Your recent time on Earth was hurried and task-oriented.\n"

			"Scarlett lives in a suburb of Syracuse. You were only on Earth for three days after \ITaft\i and \IScarlett\i were murdered, and it was
			not lost on you that you happened to be wandering upstate New York in the winter, the only place you've been that's colder than
			Phobos is outside the bubble. (You should spend a week on Vulcan, the intra-Mercurial planet that is still undiscovered as of 2044, Raif.
			It would do you some good to warm your bones.)\n"

			"You put a piece of clear adhesive over the doorknob to Scarlett's home and knocked on her door. \n"

			"She answered. She looked stunning. A few years older than you remembered, due to your extensive familiarity with her pantomime, but
			the years had given her a sensual, haunting glow that only enhanced her beauty.\n"

			"\"Raif... \" You had almost managed to drive her disappointed tone from your mind -- you turned over a new leaf when you purchased 
			her pantomime on Phobos, so \IScarlett\i had never really been all that sad, regarding you.\n"

			"\"You can't keep coming here, Raif...\" She crossed her arms, her knitted brow an obvious tome detailing how cross she was at this little
			visit. \"Goodness, it's unseasonably warm out,\" she muttered. The door swung shut. Good.\n"

			"\"I just wanted to say hello is all... \" Just something about her that makes your words impotent and uninteresting! You've spent virtually all
			of your time on Phobos in the company of a clone of hers, but the real thing leaves you feeling like naked prey.\n"

			"\"Well, write next time. You know it's over and you know I said that it would be best if we never saw each other socially. It would be healthy. 
			Look, Raif -- I've moved on. I have a baby and a wonderful husband. I'd rather there were no ties to the person I was when I was you. I
			hate that person. The calendars, the videos, the holograms... they're all in the past.\" Her voice becomes a whisper. \"Peter -- my husband, 
			Peter -- has quietly bought up the source material...\" Her lip goes stiff. \"I've moved on. The world has forgotten about me. 
			You just being here sets me back. My therapist -- \"\n"

			"There's only so much of this you can take, seeing how you were only here to facilitate growing another 'mime of her. 
			\"Okay, okay, I get it... you'll never hear from me again, I promise. You'll never see me again, either - just don't look towards the 
			stars.\"  You briefly point skywards. You begin to walk from her porch down to the gate.\n"

			"She opens the door and closes it softly. You slow down your pace, wait two beats... and bolt towards the door, rip off the putty that 
			now has a copy of her fingerprints and sprint to the shuttle downtown that will take you back to Phobos and let you make a second 
			pantomime with her binding, legal approval."
		}
		case 5
		{
			!Put a new line here because the room description will be printed
			"\n"		

			"Kangaroo probably gave you a concussion. Or he implanted a grapefruit at the top of your spine. They can do wonderful things in
			spinal surgery these days, they can do wonderful things with wrenches.\n"
			
			"Your mind wanders a bit, just firing off any old brainwave it happens to encounter on its spontaneous May Day synaptic celebration.
			You're finding a way to tell \IScarlett\i that she is a clone of a woman you loved on Earth while at a drive-in theatre that overlooks
			the rustiest red world in the known universe.\n"

			"You're trying to show \I\BJoe\i\b some video from 1993, where the guy he is a clone of a clone of hit a home run to win the World 
			Series, while discouraging him from fixating on the marshmallow fluff that \IScarlett\i bought at the grocery store earlier that day.\n"

			"You drift over to long yawn, as Chmod tries to tell you how to turn him off in case of a dire emergency, overheating, fur sprocket,
			sight-virus... one of a thousand different things he was worried about when you first met him.\n"

			"You're holding yourself back from knocking down and knocking over the guy who decided to get grabby with \IScarlett\i during a lap
			dance at Kangaroo's while you were there. You're beating the marrow out of a guy who decided to get grabby with \IScarlett\i
			during a lap dance at Kangaroo's while you were there.\n"

			"You are in the middle of explaining to \IScarlett\i just how you dusted off a guy in postal chess who was playing from Earth when \I\BJoe\i\b
			spied you across the street... and suddenly you were knocked to your back, within the grasp of a giant bear hug from a pantomime that
			somehow both lives with you and had not seen you in a thousand years.\n"

			"You are outside the life bubble on Phobos in a bleak airlock, minutes away from being thrust into an asphixiating vacuum. Er, now, I mean. 
			\IPresently.\i"
		}		

	pause
	}

	
!=====================================================================
!=====================================================================
replace DoTalk
{
local x, y, z, ok = 0

   if (object.charnumber = 1)
	{
	"Try to hold it together."
	return true
	}

   if (object.charnumber = 90) ! phone
	{
	GetMessages()
	return true
	}

   if (object.charnumber = 18) and (MrsK.hitpoints > 0)
   {
	CharExclaim(MrsK, ExclaimArray[1])

	return true
   }
   if (object is paralyzed)
	{
	CArt(object)
	print " can't really communicate in any way other than drooling due to the paralysis."

	return true
	}

  if(object is asleep)
	{
	"That person is asleep."
	return true
	}
   if (object.charnumber = 10) and (object is not switchedon)
   {
	"You can't speak to him right now."
	return true
    }
   if (object is not living) and (object is not talkable)
	{
	"You can't speak to that!"
	return true 
	}

   if (object.conscious = 0) 
	{
	CArt(object)
	print " isn't able to speak to anyone right now."
	return true
	}
   if (object.peaceful = false)
	{
	CArt(object)
	print " is way too angry to talk to you right now."
	return true
	}

! Count up all the lines by previous characters.
   if (object.charnumber > 0)
	{
	for (x=0; x < object.charnumber; x++)
		{
			y = (y + quips[x])
		}
	}


! Check and make sure you have something to say. 

   for (x=y; x<(y+quips[object.charnumber]); x++)
	{
	if (QuipOn(object.charnumber,x-y))
		{
			ok++
		}
	}


! Write contents to the screen

if (ok>0)
{

!   UpdateOpponentWindow(object)
!  "Please select one:\n\n"

 print "\n";

! List the player's choices

	for (x=y;  x < y+quips[object.charnumber]; x++)
		{
		if (QuipOn(object.charnumber,x-y))
			{
				z++
				print "\B["; number z; "]\b";
				SayQ(object.charnumber,x-y)
			}
		}

	! Get the choice

   	GetDial(z)
   	if (selected ~= 0)
 		{
		ok=0
		!print "ok is: "; number ok
		"\n";
        	   for (x=y;  x < (y+quips[object.charnumber]); x++)
			{
			if (QuipOn(object.charnumber,x-y))
				{
				ok++
				if (ok = selected)
					{
					repeat_char = object.charnumber
					repeat_line = selected
				  	Respond(object.charnumber,x-y)
					}
				}
			}
	}
	return true
		
	}
   "You can't think of anything to say right now."

}
routine GetDial (max)
{
local temp
   print "\n\BSelect an option or 0 to say nothing\b ";

   COLOR LIGHT_CYAN

   print ">> "; 

   COLOR TEXTCOLOR

    input


   if word[1]
	{
      	string(tempquip, word[1])
	}
   else
	{
       	string(tempquip, parse$)
	}

   temp = tempquip[0] - '0'

   if (temp = 0)
	{
	"\nYou decide not to say anything."
	selected = temp
	return
	}
   else
	{
	selected = temp
	}

return
}


routine SetQuip (char, line, onoff)
{
local x, y, z, n

	for (x=0; x<char; x++) 
		{
	    	 n=(n + quips[x])
		}
	n = (n + line)
	y = (n / 8)
	z = Mod(n,8)
	z = Power(2,z)
	if (onoff = 1) 
		{
	     	qflag[y] = ((qflag[y]) | (z))
		}
	if (onoff = 0) 
		{
		     qflag[y] = ((qflag[y]) & (~z))
		}
}


routine QuipOn (char, line)
{
local x, y, z, n

  for (x=0; x<char; x++) 
	{
	     n = (n + quips[x])
	}
  n = n + line
  y = n / 8
  z = Mod(n,8)
  z = Power(2,z)
  if ((qflag[y] & z) = z) 
	{ 
	return(1)
	}
  return(0)
}

routine Power (a, b)
{
local c sum
  sum = a
  if (b = 0) 
	{ 
	return(1)
	}
  if (b = 1) 
	{ 
	return(a)
	}
  for (c=0; c<(b-1); c++) 
	{
	     sum = sum * a
  	}
  return(sum)
}

!!!!!!!!!!!!!!!!!!!!!!!!
!! QUIPS DIALOGUE
!!!!!!!!!!!!!!!!!!!!!!!!
routine SayQ (char, line)
{
select(char)
   case 2:
	{
	!Scarlett 
	select(line)

	case 1: {" \"Hi, there!\""}
	case 2: {" \"Thank you for saving us seats!\""}

	case 3: {" \"HI THERE!\""}
	case 4: {" \"THANKS FOR SAVING US SEATS!\""}

	case 5: {" \"This is much better. I can hear you now!\""}
	case 6: {" \"WHAT HAPPENS IF I STILL YELL?\""}

	case 11: {" \"Are you enjoying yourself tonight, Scarlett?\""}
	case 12: {" \"I wonder what the news is tonight!\""}
	case 13: {" \"Why did they pick this place for the news?\""}

	case 14: {"\"Thanks. I was a little worried about that.\""}
	}

   case 4: 
	{
	!Scarlett3
	select(line)

	case 1: {" \"I'll get you out of this and explain everything, honey.\""}

	case 2: {" \"I love you. I have always loved you. I will always love you.\""}
	}

 case 6: 
	{
	!Cinnamon
	select(line)

	case 1: {" \"Your message was rather cryptic.\""}
	case 2: {" \"It was kind of you to call me.\""}
	case 3: {" \"Hey. How's whoring treating you, whore?\""}

	! Nice in previous encounter
	case 4: {" \"I hate mimes. I probably will Magnolia in.\""}
	case 5: {" \"Thank you so much for meeting with me.\""}
	case 6: {" \"So. What did you want to tell me?\""}
	
	! Mean in previous encounter 
	case 7: {" \"Let's just get this over with. What did you want to tell me?\""}
	case 8: {" \"I apologize for my earlier behavior.\""}
	case 9: {" \"Fork over your information, stripper skank.\""}

	case 10: {" \"Give me the good news.\""}
	case 11: {" \"The bad news.\""}

	case 12: {" \"How did you work for him for all these years?\""}
	}

  case 7: 
	{
	!Doorman / Bouncer
	select(line)

	case 1: {" \"It is extremely important that you let me in.\""}
	case 2: {" \"It is sort of important that you let me in.\""}
	case 3: {" \"I dislike you intensely. Please let me in.\""}
	}

  case 8:
	{
	! Your pantomime
	select(line)

	case 1: {" \"I didn't know they created you!\""}
	case 2: {" \"Let \B\IScarlett\b\i go!\""}
	case 3: {" \"Who have you killed here? Christ!\""}
	case 4: {" \"Put the gun down and let's talk about this.\""}
	case 5: {" \"Put the gun down or I'll kill you.\""}
	}

  case 9:
	{
	!Magnolia
	select(line)
	case 1: {" \"I didn't know you were a 'mime.\""}
		case 11: {" \"You're in luck, my girlfriend just died.\""}
		case 12: {" \"Get naked. Dance for me.\""}
		case 13: {" \"I want some money to keep this secret.\""}
		case 14: {" \"Don't worry about it. Where's Cinnamon?\""}

	case 2: {" \"Pantomimes aren't real people.\""}
		case 15: {" \"I know you're a pantomime, and now it's getting out.\""}
		case 16: {" \"I didn't know you recognized me.\""}
			case 20: {" \"Don't worry about it.\""}

	case 3: {" \"What's the drama now, whore?\""}
		case 21: {" \"Someone here killed my girl. Maybe it was you.\""}
		case 22: {" \"Where's Cinnamon, slut?\""}
		case 23: {" \"I apologize completely. Could you tell me where Cinn is?\""}


	case 4: {" \"Hi there... Are you okay? \""}
		case 17: {" \"I'm trying to find Cinnamon, actually.\""}
		case 18: {" \"Do you have a way off this moon?\""}
		case 19: {" \"You're not being coerced to stay, are you?\""}

	case 5: { "\"Have you seen Cinnamon?\""}

	case 6: { "\"Where's Cinnamon, 'mime?\""}
		case 8: {" \"Don't worry about it, dummy. Where is Cinnamon?\""}
		case 9: {" \"I apologize for being forward. I added a mod.\""}
	}

  case 10:
	{
	!Mr Chmod
	select(line)

	case 1: {" \"What's new with you, pal?\""}
	case 2: {" \"Did I tell you I know what the announcement is?\""}
	case 3: {" \"Hey, how in love with your studio apartment are you?\""}

	case 4: {" \"How the hell do I get into the club?\""}
	case 5: {" \"Who's this guy supposed to be? The doorman, I mean.\""}
	case 6: {"  \"I wouldn't want to spoil the surprise, but Phobos is going to explode.\""}

	case 9: {" \"I don't frequent strip joints. What am I supposed to do, Chmod?\""}

	case 7: {" \"My wallet! Chmod, I've lost my \Iwallet!\i\""}

	case 8: {" \"I'm having trouble focusing in here.\""}

	case 10: {" \"What are you laughing at, robot?\""}
		case 14: {" \"Me?\""}
		case 15: {" \"The President? Of America, on Earth?\""}
		case 16: {" \"You?\""}
		case 17: {" \"I give up.\""}

	case 11: {" \"What are you doing in the morgue?\""}
	case 12: {" \"Somebody tried to shoot me!\""}
	case 13: {" \"Why aren't you off Phobos yet?\""}

	case 19: {" \"This guy doesn't have any eyes.\""}
	case 20: {" \"How have I never heard of this guy?\""}
	case 21: {" \"It's nice that they did an autopsy on \ITaft\i.\""}
	case 22: {" \"What do you know about the stiff in the first slab?\""}

	!re: third Scarlett
	case 23: {" \"Thanks for your opinion. I appreciate it.\""}

	case 24: {" \"What did he do to you, buddy?\""}
	case 25: {" \"Chmod? Talk to me!\""}

	}

 case 11:
	{
	!old soul
	select(line)

	case 1: {" \"How did you get this job?\""}
	case 2: {" \"I need a membership for the night.\""}
	case 3: {" \"Can you let me in for free? I was invited.\""}
	}

 case 13 :
	{
	!Mr Kangaroo

	select(line)

	case 1: {" \"One of your girls is a pantomime.\""}
	case 2: {" \"How much longer are you going to need Cinnamon?\""}
	case 3: {" \"Excuse me, sir. I have need of Cinnamon.\""}

	case 4: {" \"You're insane! What's wrong with you?\""}
	}

case 15: 
	{
	!Ms Kitler

	select(line)

	case 1: {" \"Did I get any calls here?\""}
	case 2: {" \"I'd like a sandwich.\""}
	case 3: {" \"Are you getting off Phobos?\""}
	}

 case 16: 
	{
	!The Sun

	select(line)

	case 1: {" \"I know who you are!\""}
	case 2: {" \"Who are you?\""}

	case 3: {" \"How am I talking to the Sun??!\""}
	case 4: {" \"Am I going mad?\""}

	case 5: {" \"How can I get out of this airlock?\""}

	case 6: {" \"How can I move this boulder?\""}

	case 7: {" \"Thanks...\""}
	}
  
}


routine Respond (char, line)
{

!SayQ(repeat_char, repeat_line)
!""

select(char)
   case 2
	{
	!Scarlett
	select(line)
	case 1: {
			"\"WHAT?\" says \IScarlett\i. She gestures to the overpowering music playing."
			SetQuip(2,1,0)
			SetQuip(2,3,1)
		}

	case 2: {
			"\"WHAT? SAY AGAIN?\" says \IScarlett\i. The background music seems to squeeze all other audio right out of the room."
			SetQuip(2,2,0)
			SetQuip(2,4,1)
		}

	case 3:
		{
			"\"OH! HI THERE YOURSELF, BUSTER!\" \IScarlett\i isn't deaf or anything, it's just very noisy inside the club. \"WHAT CHANNEL ARE YOU ON?\" she
			shouts.\n"

			"\"4D4.. 94D... 65!\" you shout back. It takes forever, but it's the usual one you use so she figures it out when you're halfway through. She sets a
			register on the chip implanted deep within her spine to the same channel as you and conversation becomes quite possible without shouting. 
			It's not telepathy or anything, but doing so allows you to talk each other while the DJ plays the current diva's latest tune (in her never-ending 
			and well-precedented career track that oscillates between virgin and whore, she is firmly within the screeching whore track this month)."

			SetQuip(2,1,0)
			SetQuip(2,2,0)
			SetQuip(2,3,0)
			SetQuip(2,4,0)

		}

	case 4:
		{
			"\"NO PROBLEM!\" she shouts. \"THE STRIPPERS KEPT THEM WARM FOR YOU.\" Chmod gives his version of a thumbs-up to the crowd at this
			and accidentally vacuums up a neon test tube shot. \"WHAT CHANNEL ARE YOU ON?\" asks \IScarlett\i.\n"

			"\"4D4.. 94D... 65!\" you shout back. \IScarlett\i sets a register on the chip implanted in her spine so that the two of you can talk without
			shouting. The process is not mind-reading or anything, it just tunnels what the two of you say directly into each other's brains. "

			SetQuip(2,1,0)
			SetQuip(2,2,0)
			SetQuip(2,3,0)
			SetQuip(2,4,0)
		}

	case 11: 
		{
	
			"\"I certainly am!\" exclaims Scarlett. \"It's nice to spend a quiet evening together,\" she says with a sweet smile." 

			SetQuip(2,1,0)
			SetQuip(2,2,0)
			SetQuip(2,3,0)
		}

	case 12: 
		{
			"\"I do too,\" says \IScarlett\i. \"I haven't heard anything at the paper about what this might be. Well, whatever it is, we're certainly
			in a place to celebrate!\" She has to yell a bit to get over the inherent commotion of the venue."
			SetQuip(2,1,0)
			SetQuip(2,2,0)
			SetQuip(2,3,0)
		}

	case 13:
		{
			"\"Well,\" begins \IScarlett\i, \"
			
			Of course, sweetheart,\" she beams. \"What's wrong? Not feeling well?\" Without waiting for an answer she recaps the events of the
			evening tonight.  \"I know you've been under a lot of stress lately. We're here 
			
			\"We're here to see if \ITaft\i will accept the nomination to be on the upcoming ticket for Governor... I
			think he will. I think the logical thing to do if you're not interested and going to be the toast of a huge party like this is to simply
			say 'No thank-you' and save the party the thousands in scrip it cost to rent this place out if you're not up for busting another
			lifetime of trusts.\""

			SetQuip(2,1,0)
			SetQuip(2,2,0)
			SetQuip(2,3,0)
		}

	case 14: 
		{
			"\"No problem,\" says \IScarlett\i. \"I could kind of tell that you were a little distant. But places such as these -- \" She gestures
			all over, causing one of the girls to wander towards your table before you wave her off -- \"Well, they can be intimidating at first.
			I don't know how much experience you've had with them, but I think it takes a few visits before you can really relax and enjoy
			yourself. It's also very warm in here, which might also cause some discomfort.\" Another reassuring smile."

			SetQuip(2,4,0)
		}
	}

   case 4
   {
   !Scarlett3
   select(line)
	case 1: 
	{
		"\B\IScarlett\i\b quietly nods her head, very much trembling, however."
		SetQuip(4,1,0)
	}

	case 2: 
	{
		"\"I just want you to tell me what's going on,\" she says. \"I don't understand any of this...\"\n"

		"You hold her close, hoping to God that you'll be able to make things right this time, that things will 
		be different...\n"

		"\"I'll explain everything. I got you a ring, you know... I don't mean the ring that Phobos will become in 
		a few minutes, either. I mean, I real, genuine...\" You're not able to really get the words out at this point
		because she kisses you.\n"

		"A policeman brings out what's left of Chmod from the Club. Cinnamon and Mrs. Kangaroo appear
		shortly behind him. He yells at everyone who can hear. He's bringing the last group of people to the
		last shuttle off Phobos.\n"

		"\B\IScarlett\i\b breaks your kiss, comports herself, gets herself ready for the flight back to 
		Earth. \"It's so cold here, Raif. It's so cold...\"\n"

		"\"I made a deal with the Captain. He said we can stick our arms out the window when the shuttle takes off,
		to warm us up a bit. \"\n"

		"She laughs, which sets off another round of busy, sloppy kissing.\n"

		"The last man and woman to ever walk on Phobos make it into the shuttle and off the moon just in time. Poor 
		Phobos. I was always fond of Phobos."

		SetQuip(4,2,0)

		pause

		endflag = 3
	}
}

		

   case 6:
   {
   !Cinnamon
   select(line)
	case 1: 
	{
		"Kangaroo butts in with his unwelcome take.\n"

		"\"I had no idea that you two were close. Boy's back on the market though, isn't he Cinn? Gotta jump on that! Ha ha ha... \"\n"

		"Cinnamon neatly passes you a look during his asinine self-induced laughter. The look conveys a lifetime of contempt for her boss and you rediscover
		how thrilled you are at your lack of a full-time job.\n"

		"\"Why don't we get together in a little bit, Raif? Can you meet me at the diner in an hour?\" Without waiting for confirmation she turns her attention back to her boss.
		You take the social queue to mean that you should be leaving."

		SetQuip(6,1,0)
		SetQuip(6,2,0)
		SetQuip(6,3,0)
		SetQuip(13,2,0)
		SetQuip(13,3,0)

		GameEvents[13] = 1 ! through with Cinnamon 
	}

	case 2:
	{
		Kangaroo.karma += 1

		"Cinnamon's boss apparently wasn't done with her and you get the feeling that you interrupted a meeting. \n"

		"\"Hey... you're the guy whose wife died the other night, aren't you?\"\n"

		"\"She wasn't my wife, but yes. I'd like to register a complaint. Dancers were good looking, drinks were delicious, corpses generated were numerous and difficult
		to carry out of club. F minus.\"\n"

		"\"At least you've got a good attitude about it, eh champ? Ha ha ha! Well, I won't need Cinnamon here for much longer and then she's all yours!\"\n"

		"Cinnamon rolls her eyes. \"Let's meet at the diner in a little bit, Raif. Would that work?\"\n"

		"\"That will be great. Be careful though! I'm running on a cold streak here with women!\" Kangaroo laughs because he's an asshole, which suits your purposes. Cinn
		and Mr Kangaroo wait for you to quietly exit."

		SetQuip(6,1,0)
		SetQuip(6,2,0)
		SetQuip(6,3,0)
		SetQuip(13,2,0)
		SetQuip(13,3,0)

		GameEvents[13] = 1 ! through with Cinnamon 
	}

	case 3:
	{
		Kangaroo.karma += 2
		Cinnamon.karma -= 2

		"Mr Kangaroo throw out a deep belly laugh. \"You've got that right, boy! I don't have to tell you how to treat these bitches! You're not looking for a \Ijob\i are you?\" 
		Cinnamon can't believe what came out of your mouth. She opens and closes it a couple times with no words leaving her lips.\n"

		"Kangaroo continues unfettered. \"I've just got to finish up with this slut and then she's all yours. Isn't that right, honey?\"\n"

		"With the hate of a hundred suns Cinnamon nods her head. \n"

		"\"Great,\" says Kangaroo, \"Why don't you two meet at the diner? It's on me.\" He winks at you. \"I'll call ahead.\""

		SetQuip(6,1,0)
		SetQuip(6,2,0)
		SetQuip(6,3,0)
		SetQuip(13,2,0)
		SetQuip(13,3,0)

		GameEvents[13] = 1 ! through withCinnamon 
	}   

       case 4: 
      {
		"\"All right, we're obviously done here,\" she says. \"I don't know what's gotten into you, but it's despicable.\"\n"

		"\"What did you want to tell me? Do you want that frigging mime to get off the planet or die here? I can make it so that nobody comes for her. Keep
		pushing me here.\"\n"

		"Cinnamon actually smiles at you, she's so frustrated. \"Kangaroo's wife was sleeping with her business partner. I got a hold of the
		access code to get into her apartment, but fuck you.\"\n"

		"Cinnamon gives you a great view of her ass and middle finger as she struts out of the bar and out of your life."

		remove Cinnamon 

		GameEvents[29] = 0 ! Did Cinn give Raif the access code to Mrs Kangaroo's?
		GameEvents[30] = 1 ! Can Raif get into Mrs Kangaroo's house? 

		SetQuip(6,4,0)
		SetQuip(6,5,0)
		SetQuip(6,6,0)
      }

      case 5:
      {
		Cinnamon.karma += 1

		"\"No, thank you, Raif...\" Her tone is reserved, compassionate. \"I was always really fond of \IScarlett.\i It had been far too long since the two
		of us last got together. I think I only saw her twice since Kangaroo fired her, but both times she seemed so sad... I think it pained her to not have a job 
		out here. She mentioned that she didn't want to be a freeloader.\"\n"

		"(Since Mr Kangaroo fired her? That's a new one for me, Raif!)\n"

		"\"It was tough for both of us,\" you say. There's just something warm about Cinnamon that makes her easy to talk to. 
		\"She didn't have a whole lot of friends, except at work and with her aquarium club. Two very different kinds of clubs, now that I think about it! 
		Meanwhile, I was spending all of my time with a low-end, de-featured , animate vacuum cleaner and a second  generation copy of a guy who was 
		born almost a hundred years ago. I mean, I barely understand \I\BJoe\i\b most of the time, and she... well, \I\BJoe\i\b reminded her of the 
		fact that she was a pantomime as well. It was hard, what with his mental handicap. She used to say that, regardless of the ups and downs of 
		the job, dancing on a pole at least let her forget that she was a copy.\"\n"

		! if Raif in table!!!
		if parent(player) = booth
		{
			"Neither of you say anything for a few moments. Cinnamon reaches out to touch your hand.\n"
		}
		else
		{
			" Neither of you say anything for a few moments. Cinn turns to you, looking up and smiling, finally.\n"
		}

		"\"I did have some information for you,\" says Cinn. \"Do you want the good news or the bad news?\""

		SetQuip(6,4,0)
		SetQuip(6,5,0)
		SetQuip(6,6,0)

		SetQuip(6,10,1)
		SetQuip(6,11,1)
	}

	case 6:
	{
		"\"Right,\" says Cinn, through pursed lips. \"You're all business, now. I forgot.\"\n"

		"\"I don't mean to come off in any particular way,\" you tell her, \"But I've a very hard deadline here. Both before the last ship comes to get me off this
		rock and before the moon itself blows up.\" You overextend an attempt at a genuine smile, ruining it.\n"

		"\"It just seems... well, like you were personally \Ioffended\i that \IScarlett\i was murdered, as opposed to -- \"\n"

		"You cut her off. \"Look, honey, I just need the information you were going to give me. That's it.\"\n"

		"\"No, you listen, Raif! \IScarlett\i was a good friend of mine! You never came down to the club when we were both working, you don't know how
		it was! It wasn't always a, how do you say, 'thrill-a-millichron?' It definitely wasn't \Ithat.\i She used to tell me that after spending time with your one
		friend -- \"\n"

		"\"A copy of a copy of a baseball player, right, my friend \B\IJoe.\i\b. Jesus -- \"\n"

		"\"That she'd rather be dancing around a pole than have to be constantly reminded of her origins.\"\n"

		"(Nobody speaks for a little bit, but \IScarlett\i working at Kangaroo's is certainly news to me!)\n"

		"\"That's no surprise,\" you say, finally. \"\B\IJoe\i\b has some problems, but I didn't think the right thing to do was to leave him digging out of a 
		dumpster for food and shelter.\"\n"

		"\"She didn't either, of course,\" says Cinn. \"It's just... yeah.\"\n"

		"\"Yeah. You had some information for me.\"\n"

		"\"Well...\" Cinnamon looks around for a cigarette. \"Do you want the good news or the bad news?\""

		SetQuip(6,4,0)
		SetQuip(6,5,0)
		SetQuip(6,6,0)

		SetQuip(6,10,1)
		SetQuip(6,11,1)
	}

	case 7: 
	{
		"\"What turned you into suck a prick?\" asks Cinnamon.\n"

		"\"The death of my girl. What else? She's dead and there isn't anyone in the solar system who's going to lift a finger to find out why... because she was
		a pantomime of somebody else.\"\n"

		"\"Does the real, ah... the first Scarlett know about \IScarlett's\i death?\" Your silence gives Cinnamon all sorts of insight. \"Wait, does Scarlett even know
		you made a clone in the first place?\"\n"

		"\"It doesn't matter. She'll find out, I'm sure. They can't keep the full details of \ITaft's\i death hidden forever, there will be more disseminated eventually.\"\n"

		"\"Good God, Raif! What do you think is going to happen when the original woman finds out that her mime was dancing topless around Phobos before getting murdered?\"
		You wince. Hey, this is all news to me, Raif!\n"

		"\"She can think whatever she wants to. I don't care. If she didn't break things off it never would have come to this. Look, Cinn, I'm on a deadline here. What did you
		want to tell me?\"\n"

		"Cinn isn't ready to let things go, but she doesn't argue with your announcement of a deadline. \"Want the good news or the bad?\""

		SetQuip(6,7,0)
		SetQuip(6,8,0)
		SetQuip(6,9,0)

		SetQuip(6,10,1)
		SetQuip(6,11,1)
	}

	case 8: 
	{
		Cinnamon.karma +=3

		"\"Were you trying to be funny earlier? What's gotten into you?\"\n"

		"\"This is just a really stressful time. All we're going on, in terms of exactly when the moon is going to ring out, is a speech of \ITaft's\i. We're just
		taking it on faith that the science is right. Science once thought Phobos would be destroyed several thousand years from now. I don't have a ticket
		on a shuttle off of here, either.\"\n"
			
		"\"Hey... it's going to be all right.\" She squeezes your hand. \"\IScarlett\i always used to say what a wonderful guy you were when she was working
		down at the club.\"\n"
		
		"(Whoa! News to me, Raif! I didn't know she worked there.)\n"
		
		"\"She had faith in you,\" continues Cinn. \"There isn't anyone else on this moon that is better equipped to figure out what happened. And the government
		isn't going to let you die here. That's what governments are for. Look, Raif... I have some good news and bad news that may help your 
		investigation. Which do you want first?\""		

		SetQuip(6,7,0)
		SetQuip(6,8,0)
		SetQuip(6,9,0)

		SetQuip(6,10,1)
		SetQuip(6,11,1)
	}

	case 9: 
	{
		Cinnamon.karma -= 3

		"Cinn looks stunned before just shaking her head dismissively at you.\n"

		"\"\IScarlett\i always said you had a dark side. I guess this is it revealing itself.\"\n"

		"\"When did she ever talk about me to you?\"\n"

		"\"When she got done being felt up by some drunken slob down at the club. She'd need a few minutes to compose herself.\"\n"

		"(\IScarlett\i worked there? News to me, Raif!)\n"

		"\"If you two weren't great dancing buddies maybe she wouldn't have been inches from center stage that night. What did you want to tell me?
		Do it for her and her memory if you've got some sort of problem with me all of a sudden.\"\n"

		"\"You can take a flying fuck. I was going to tell you that Kangaroo's wife was sleeping with his business partner, but I'm not going to be treated this
		way by anyone, especially by the likes of you. She lives in the mansion at the corner of Crennel and Park. You can give it a look or you can drink lye. I don't
		care which.\"\n"

		"Cinnamon leaves the booth, never giving you or your problems a second thought."

		GameEvents[29] = 0 ! Did Cinn give Raif the access code to Mrs Kangaroo's?
		GameEvents[30] = 1 ! Can Raif get into Mrs Kangaroo's house? 

		remove Cinnamon 

		SetQuip(6,7,0)
		SetQuip(6,8,0)
		SetQuip(6,9,0)
	}

	case 10: 
	{
		"\"Okay. I can help you with that. The good news is that Kangaroo had a wife and she was sleeping with her husband's business partner.\"
		Cinn reflects on the way that came out. \"Obviously, this is not good news for any of the people in that sentence.\"\n"

		"\"I understand. It's not good news for that business partner, as he's currently staring into oblivion in the morgue.\"\n"

		"\"No! Someone killed him? Oh, wow... Huh. How about that.\"\n"

		"The religious upbringing that both of you received until about age four rears its head and you both share a moment of silence. \n"

		"\"What's the bad news?\" you ask, after a respectful pause.\n"

		"\"She may already be off the moon. She lived -- lives -- in the mansion on the corner of Crennel and Park. Just north a bit from here. 
		I hope she will be able to tell you more. The code to get into her place is six fives.\"\n"

		"\"Security through repetition. Gnarly. Thanks, Cinn... this is a big help. Thank you.\""

		GameEvents[29] = 1 ! Did Cinn give Raif the access code to Mrs Kangaroo's?
		GameEvents[30] = 1 ! Can Raif get into Mrs Kangaroo's house? 

		SetQuip(6,10,0)
		SetQuip(6,11,0)
	}

	case 11: 
	{
		"\"Well, there is someone critical to your investigation that may no longer be on Phobos.\"\n"

		"\"Oh. That's pretty bad news. I was hoping to not have to open up my search criteria to all humans in the solar system, no matter
		where they might be.\"\n"

		"\"She might still be here. It's Kangaroo's wife.\"\n"

		"\"He has a wife!\" You let loose with a guffaw (you deserve it). \"Who'd marry that thing?\"\n"

		"\"He has a lot of money... big fish in a small pond syndrome? I honestly don't know. Mrs. Kangaroo lives up on the corner of Park and Crennel,
		in the mansion. If she's there, she should be able to tell you that she's been sleeping with Kangaroo's business partner and who
		knows what else. If you need to break in, the access code is all fives.\"\n"

		"\"Well, the guy who was in business with Kangaroo is dead... I just caught him over at the morgue. Actually, you can too, he can't really see
		himself going anywhere -- \"\n"

		"\"Huh. I never met him. I was just vaguely aware that Kangaroo had a partner in everything out here. This is getting dirtier and dirtier.\"\n"

		"\"Thanks, Cinn... this is all a great help. I really do appreciate it. What was the good news?\"\n"

		"\"I'm in the \ICasablanca\i remake! I start when I get back to Earth. I have my own trailer and everything.\" 
		She sees you lose focus and then snap back. \"Well, it's good news for me,\" she says, meekly."

		GameEvents[29] = 1 ! Did Cinn give Raif the access code to Mrs Kangaroo's?
		GameEvents[30] = 1 ! Can Raif get into Mrs Kangaroo's house? 

		SetQuip(6,10,0)
		SetQuip(6,11,0)
	}
	case 12: 
	{
		"Cinnamon just shakes her head. \"He rounded me up earlier... he just snapped, Raif. I guess he had been plotting everything for
		quite some time."

		SetQuip(6,12,0)
	}
   }

   case 7:
   {
   !Doorman / Bouncer
   select(line)
	case 1: 
	{
		"\"You need a keycard to get in tonight,\" says the doorman. \"Because of the high security.\" An older French
		guy appears from the club and touches the doorman on the shoulder. \n"

		"\"Excusez-moi, I need to get more scrip out of my cycle.\"\n"

		"The doorman gives him permission with a brief wave. \"Just go right in when you get back,\" he says. He
		turns his attention to you as the Frenchman leaves. \"Anyway, show me a keycard and you're all set. Until then, I'll have to ask
		you to not get aggressive.\""

		SetQuip(7,1,0)
		SetQuip(7,2,0)
		SetQuip(7,3,0)
		SetQuip(7,4,0)
	}

	case 2: 
	{
		"\"Yeah, okay, but you need a keycard to get in tonight,\" replies the doorman. \"You know. Because of the high
		security and everything.\" An older German gentleman appears from the club and passes.\n"

		"\"Entschuldigen Sie mich! I need to get more scrip! Haha!\"\n"

		"The doorman nods. \"Just go right in when you get back, pal.\" He turns his attention back to you as
		the German leaves. \"Anyway, show me a keycard and you're all set. Until then, I'll have to ask you to stand in line and wait.\""

		SetQuip(7,1,0)
		SetQuip(7,2,0)
		SetQuip(7,3,0)
		SetQuip(7,4,0)
	}

	case 3: 
	{
		"\"I understand. I understand completely,\" says the doorman. \"But I can't tonight. A former President is in there! Security
		is very high.\"\n"

		"An older Russian guy appears from the back of the club and pats the doorman on the shoulder. He says something incomprehensible.\n"

		"The doorman waves and gives a strained smile. \"Yeah, just return to the front of the line when you need to come back,\" he mumbles
		as the Russian leaves. He turns his attention back to you. \"Anyway, yeah, just show me a keycard and I can let you in.\""
	}

   }

   case 8:
   {
   !Your pantomime
   select(line)
	case 1: 
	{
		"\"I don't care.\" Your pantomime stares at you, trying one hateful expression on after another. \"Would you react in any other way? 
		I didn't even know English when I got out of the motherfucking vat. I had to \IIearn English,\i fucker!\" \IRaif\i  starts waving 
		the gun around, growing all the more animated..."

		Joe_Knocks_Clone()

		SetQuip(8,1,0)
	}

	case 2: 
	{
		"\"I'm going to shoot her at the last possible moment, fucker. No matter how many you grow -- what are you going to do if they fuck up and bring in
		a brainless copy of her like they did me? Are you going to teach her how to eat and speak and fucking, fucking, drive and -- \"\n"

		"You can't help but interrupt. \"Someone taught you how to drive? They didn't, did they! You probably hopped on the freeway anyway! You're the 
		reason I left Earth in the first place!\"\n"

		"\IRaif\i begins an articulate response, growing more and more animated, waving the pistol around..."
		
		Joe_Knocks_Clone()

		SetQuip(8,2,0)
	}

	case 3: 
	{
		"\"I've got quite a number. Everyone down at the cloning center. The women first. The men howled and howled and cried and all their little office
		romances went straight into the shitter of my pistol. I killed that fat fuck \ITaft\i... He was just in the fucking way. I killed this girl, because I knew
		it would hurt you... I don't even remember how many people on Earth just to get here. Ha! There was at least one instance...\"\n"

		"\IRaif's\i speech drifts into dementia as he gets more and more animated and pulls the pistol away from \B\IScarlett's\b\i head..."

		Joe_Knocks_Clone()	

		SetQuip(8,2,0)
	}

	case 4: 
	{
		"\"Fuck you!\" He hasn't fallen all that far from the tree, has he, Raif?"
		SetQuip(8,4,0)
		SetQuip(8,5,0)
		SetQuip(8,1,0)
	}

	case 5:
	{
		"\"Oh, you can try, fucker, you can fucking try! You have no idea how long I've fucking waited for this! Do you have any idea how good I am with this thing?\"\n"

		"\IRaif\i pulls the gun away from \B\IScarlett's\b\i  head, getting wilder and more animated..."

		Joe_Knocks_Clone()

		SetQuip(8,5,0)
	}
}

   case 9:
   {
   !Magnolia
   
   select(line)
      case 1: 
	{
		Magnolia.karma -= 1

		GameEvents[11] = 1

		PM(Magnolia)
		" stops dead, frozen by your words. She looks at you, really looks at you, for the first time.\n"

		"\"How did you know that?\" She says it, but she says it in a way that doesn't imply that you're right. Though you are, of course.\n"

		"\"I have a microchip inserted in my spine and added a mod that views pantomimes. In my field of vision, the word 'pantomime' is above your head.\n"

		"\"What do you want? Nobody else knows, except Cinnamon.\" Her voice is very hushed. \"What do you want? I can't have this getting out. I'll
		be fired. I'll lose my job.\""

		SetQuip(9,1,0)
		SetQuip(9,2,0)
		SetQuip(9,3,0)
		SetQuip(9,4,0)
		SetQuip(9,5,0)
		SetQuip(9,6,0)

		SetQuip(9,11,1)
		SetQuip(9,12,1)
		SetQuip(9,13,1)
		SetQuip(9,14,1)
	}

	case 11:
	{
		"\"How does that make me lucky?\" she asks.\n"

		"\"I don't need to see you shake anything around for my pleasure. I'm just not interested. All I care about is finding out who killed my girl. Cinnamon left me a 
		message saying that she had some information for me and that I could meet her here.\"\n"

		"\"She's in the office, with the boss... Look, I'm really sorry that your girlfriend was killed. You probably feel like lashing out at everyone and everything. I'm 
		just asking you not to take it out on me. I'll do anything you want. Just don't turn me in. I need this job for another two weeks or else I honestly
		don't know how I can afford to get off the moon.\""

		SetQuip(9,11,0)
		SetQuip(9,12,0)
		SetQuip(9,13,0)
		SetQuip(9,14,0)
	}

	case 12:
	{
		Magnolia.karma -= 1

		"\"I can't do it here,\" she says. \"Come to my apartment in a couple hours. I'll put on a show for you. I'll do anything you want. If Mr Kangaroo finds out I am not real
		he'll fire me. That will be the least of what he does to me. Give me time to get ready. Once we do this, we're square. If I get fired I can't afford to get off Phobos.\"\n"

		"\"I don't have a couple hours. Just get lost.\""

		SetQuip(9,11,0)
		SetQuip(9,12,0)
		SetQuip(9,13,0)
		SetQuip(9,14,0)
		SetQuip(9,20,0)
	}

	case 13:
	{
		Magnolia.karma -= 3

		"\"Okay,\" she says. \"Sure. And if I pay you, you shut up about this? Mr Kangaroo will fire me if he finds out I'm not real. I need this job to get off the moon. I can
		get you $300 in scrip, but I need some time.\" She digs into her purse looking for something to write on, presumably. \n"

		"You give her your electronic destination address for deposits. \"Just make sure the money's in my account,\" you tell her. \"Get lost.\""

		SetQuip(9,11,0)
		SetQuip(9,12,0)
		SetQuip(9,13,0)
		SetQuip(9,14,0)
	}

	case 14:
	{
		Magnolia.karma += 1

		"\"What do you mean don't worry about it? Do you know what would happen if this got out? I'd be stuck here!\"\n"

		"\"I'm sorry I blurted that out. Okay? I'm supposed to meet Cinnamon here. Can you tell me where she is? Please?\"\n"

		"\"Who are you?\" She's folded her arms. It seems obvious that she thinks you're some kind of psycho.\n"

		"\"My girlfriend died the other night... she knew Cinnamon. Look, I got a call from her, and I really need to speak to her. I was off this rock but came back to get some 
		answers, and I think Cinnamon has some.\"\n"

		"\"She's in the office with Mr Kangaroo. She should be out in a little bit.\""

		SetQuip(9,11,0)
		SetQuip(9,12,0)
		SetQuip(9,13,0)
		SetQuip(9,14,0)
		SetQuip(9,8,0)
		SetQuip(9,9,0)
	}

	case 2: 
	{
		GameEvents[11] = 1

		"\"I'll be sure to remember that,\" she murmurs, \"If I ever encounter any.\" She stops going through her purse and looks up at you. \"Oh, I'm sorry,
		your clone girlfriend was killed the other night. My bad!\" She goes back to her handbag."

		SetQuip(9,1,0)
		SetQuip(9,2,0)
		SetQuip(9,3,0)
		SetQuip(9,4,0)
		SetQuip(9,5,0)
		SetQuip(9,6,0)
		SetQuip(9,15,1)
		SetQuip(9,16,1)

	}

	case 15:
	{
		Magnolia.karma -= 1

		PM(Magnolia) 
		" isn't feeling quite as confident now. You've managed to stop her from furiously sorting the objects in her purse. Her next question is a whisper.\n"

		"\"How do you know? I haven't told anyone! Please don't tell anyone... \"\n"

		"\"Tell me where Cinnamon is or else I'm barging into your boss's office and letting him know immediately. How would that feel, ";
		PM(Magnolia) 
		"? Would you like that?\"\n"

		"\"She's in his office! Please! I'll do anything, just don't let this out! What do you want?\""

		SetQuip(9,15,0)
		SetQuip(9,16,0)
		SetQuip(9,12,1)
			SetQuip(9,13,1)
		SetQuip(9,20,1)

	}

	case 16:
	{
		"\"I remember you,\" she said. \"You were with that robot who added to the panic the other night. You two make a great team.\"\n"

		"\"I drank some code that enabled my mod chip to see pantomimes,\" you state, matter-of-factly.\n"

		"\"How about drinking some that would give you tact? Do they sell that in liquid form?\"\n"

		"\"No. Probably not... I don't know.\"\n"

		"\"So, what do you want?\" She assumes a defensive posture -- hands on hips, suggestive lips forming a frown. \"Do you think I'm
		going to blow you now or something? I would have thought that you would have at least experienced a period of mourning.\""

		SetQuip(9,15,0)
		SetQuip(9,16,0)
		SetQuip(9,11,1)
		SetQuip(9,12,1)
		SetQuip(9,13,1)
		SetQuip(9,14,1)
	}

	case 20
	{
		"\"Thank you,\" she says. I do appreciate it. Sorry if I sounded rude earlier... \"\n"

		"\"I  understand. It's stressful for everyone. I'm going to wait for Cinn to get out of her meeting, if that's okay.\"\n"

		"\"Of course. She shouldn't be in there for very long... I have to go...\" It's almost as if she wants you to reaffirm your word that you're not going to turn her in. Turn her in! As if there's something
		wrong with what she is. As if you didn't love someone who was engineered in a vat rather than a womb yourself.\n"

		"\"You take care. Get off this moon as quickly as you can. And best of luck, ";
		PM(Magnolia)
		".\""

		"She seems reassured by that."
	}

	case 3: 
	{

		Magnolia.karma -= 1

		GameEvents[11] = 1

		"Without missing a beat she has a response for you. \"You've got more issues than -- \"\n"

		"\"Spare me the tired simile.\"\n"

		"\"A simile uses like or as,\" she says.\n"

		"\"Oh. I guess you don't have to spare me the English lesson, that's perfectly fine.\" This is embarrassing.\n"

		"\"Don't call me a whore. What's the matter with you? There's maybe thirty people left and you're treating them all like shit, one-by-one? \""

		SetQuip(9,1,0)
		SetQuip(9,2,0)
		SetQuip(9,3,0)
		SetQuip(9,4,0)
		SetQuip(9,5,0)
		SetQuip(9,6,0)
		SetQuip(9,21,1)
		SetQuip(9,22,1)
		SetQuip(9,23,1)

	}

	case 21
	{
		Magnolia.karma -= 1 

		"\"Well, then you're never going to find out who killed her. Who's going to talk to you? You're not a cop or anything. What did you do here? I certainly
		never saw you work or anything.\"\n"

		"\"I won a trip to this Paradise thanks to a chess tournament. I wasn't going to go, but I woke up the day of the flight tied into the shuttle seat with shroud-laid rope.\"\n"

		"\"Who did that? Your friends?\"\n"

		"\"FIDE. They are angry, calculative people that you would do well to avoid should you make it back to Earth. I personally recommend checkers, or any
		game that includes primary color hippopotamuses these days.\"\n"

		"\"I'll remember that. What do you want?\" she asks. \"Are you crushing on me?\"\n"

		"\"I'm trying to find Cinnamon.\"\n"

		"\"She's in a meeting with the boss, in the back office. I've got to be someplace else now. \""

		SetQuip(9,21,0)
		SetQuip(9,22,0)
		SetQuip(9,23,0)
	}

	case 22
	{
		Magnolia.karma -= 2 

		"\"Go fuck yourself!\""

		SetQuip(9,21,0)
		SetQuip(9,22,0)
		SetQuip(9,23,0)
	}


	case 23
	{
		"She doesn't trust you, but she's sufficiently surprised by your apology that she at least decides to communicate with you.\n"

		"\"She's meeting with the boss... in the office back there. Why do you want to see her?\"\n"

		"\"She left a message on my phone. In fact, she was the one who wanted to see me.\"\n"

		"\"That's weird. No offense! I mean no offense. It's just odd that she'd call up a customer.\"\n"

		"\"Who said I'm a customer? Christ, you come in here for a night because they're announcing the destruction of Phobos and all of a 
		sudden you're a regular. All of a sudden I'm a regular.\"\n"
		
		"\"I thought I saw you come in with your robot quite often? I guess I had you confused with someone else.\"\n"
		
		"\"We weren't here that much. God, maybe we were. Well, this is embarrassing.\"\n"

		"\"For both of us!\" exclaims ";
		PM(Magnolia)

		", brightly."

		SetQuip(9,21,0)
		SetQuip(9,22,0)
		SetQuip(9,23,0)
	}


	case 4:
	{
		Magnolia.karma += 1

		GameEvents[11] = 1

		"\"I'm fine...\" she says, with a lengthy pause not usually indicative of wellness. \"You wouldn't believe the things you have to do around
		here to stay employed. Rotten moon can blow itself up into a million chunks and it wouldn't be too many. Thanks for asking, though. 
		Is there someone around here you're looking for?\""

		SetQuip(9,4,0)
		SetQuip(9,1,0)
		SetQuip(9,2,0)
		SetQuip(9,3,0)
		SetQuip(9,5,0)
		SetQuip(9,6,0)

		SetQuip(9,17,1)
		SetQuip(9,18,1)
		SetQuip(9,19,1)
	}

	case 17:
	{
		Magnolia.karma += 1

		"\"She's still in that meeting, unfortunately...\" "; 
		PM(Magnolia) 
		" bites down on her lip, just barely nibbling on it. \"Are you a friend of hers?  Did you know her on Earth?\"\n"

		"\"How did you know I just got back from Earth?\"\n"

		"\"What? I didn't... But now that you mention it, you don't smell like this place. This place is a jungle and you don't smell harsh. But is that your thing?
		If someone asks you the time do you yell at them about \Ihow they just knew\i you were on Earth?\" She says it playfully, friendly. \n"

		"\"Maybe. Ugh... Yeah. No, to answer your question: Cinnamon left a message on my phone to meet her here. That's all.\"\n"

		"\"Good for you! She's one of the few girls around here who chooses to not bring a straight razor to work. She should be out in a minute.\" Well, it's
		good to know that she won't be trying to slit your throat when she arrives, nor remove the 'Mourning Beard' you've been working on."

		SetQuip(9,17,0)
		SetQuip(9,18,0)
		SetQuip(9,19,0)
	}

	case 18:
	{
		"\"As long as I stay employed I do. I'm not really what you would call 'good' with money... I, well... I sometimes get a case of the 'gimme gimmes' and
		it doesn't matter that I'm all the way out here instead of back home, I just get a craving for new things, trinkets and the like. What - how did you
		get up here?\"\n"

		"\"I came up here for a chess tournament. \"\n"

		"\"Did you win?\"\n"

		"\"I think it's pretty clear that I lost.\" You shrug.\n"

		"\"Ah! Very good. No, but seriously, did you win the tourney you flew out here for?\"\n"

		"\"I overslept. I missed the event by a fifth but they wouldn't let me in. A fifth of an hour, you might ask? No, a fifth of grain alcohol. It
		hardly matters now. I had the good parts of my spinal column replaced with a microchip and had them stop my desire
		to drink.\"\n"

		"\"I didn't know that was something that originated in your spine,\" she says, brows knit.\n"

		"\"Oh. Well, that's what they told \Bme\b. I guess I just fell off the wagon if what you say is true. I should mark the time, I suppose.\" She smiles.\n"

		"\"Were you looking for Cinn? She's in the office there with the boss.\"" 

		SetQuip(9,17,0)
		SetQuip(9,18,0)
		SetQuip(9,19,0)
	}

	case 19:
	{
		PM(Magnolia) 
		" looks at you for an instant too long, trying to gleam your angle. She clears her throat and lets out a small 'ha.'\n"

		"\"I'm not here against my will,\" she says. \"No more than anyone else who made it to Phobos and didn't turn right around when
		they got here. I just need my last check is all. I have a family and a future just waiting for me, only it's not here, it's on Earth.\"\n"

		"\"Everytime I think about going back, I make myself remember the weather. If I don't immediately enter the fetal position, I swallow
		broken glass and shots of lye.\""

		"\"Where did you drive that it was that bad?\"\n"

		"\"Syracuse,\" you say. \"And then I came here, where the world is breaking up into a ring. The ultimate in bad weather! Sort of makes Pompeii seem
		like a brief summer sun shower, doesn't it?\""

		SetQuip(9,17,0)
		SetQuip(9,18,0)
		SetQuip(9,19,0)
	}

	case 5: 
	{
		GameEvents[11] = 1

		"\"What are you,\" she says, \"convinced you're in love with her? Or that she's in love with you?\" She never bothers to look up. \"I know you
		think it was magic, but -- \"\n"

		"\"I'm not a fucking customer.\"\n"

		"Undaunted, she continues. \"It wasn't. You're just a mark.\" She looks up at you, now that it's on her terms. The distinction seems important to her.
		\"She's in the office trying to  get out of a contract she has with the boss. You're probably \Inot\i a mark, now that I think about it. If you stuck 
		around here because you thought you had to be with a dancer then you'd be the saddest person in the solar system, God.\""

		SetQuip(9,5,0)
		SetQuip(9,1,0)
		SetQuip(9,2,0)
		SetQuip(9,3,0)
		SetQuip(9,4,0)
		SetQuip(9,6,0)
	}

	case 6:
	{
		Magnolia.karma -= 1 

		GameEvents[11] = 1

		"\"Ha ha, what?\" she says, caught offguard. \"Pantomime, what?\"\n"

		"\"They say that stripping doesn't lead to acting because your instincts aren't shaped to appeal to anyone other than desperate males, who make up a statistically
		insignificant portion of the television and cinema consuming audience.\" You're surprised that she let you get through that much of your response, you would
		have pegged her as the type to roll her eyes at longer, meandering sentences.\n"

		"She rolls her eyes. \"Whatever. How did you find out? There isn't anyone I told on Phobos. Did you find out on Earth or something? \""

		SetQuip(9,1,0)
		SetQuip(9,2,0)
		SetQuip(9,3,0)
		SetQuip(9,4,0)
		SetQuip(9,5,0)
		SetQuip(9,6,0)

		SetQuip(9,14,1)
		SetQuip(9,8,1)
		SetQuip(9,9,1)
	}

	case 8
	{
		Magnolia.karma -=1 

		"\"Don't talk to me like that!\"\n"

		"\"I don't like pantomimes. It's not my fault if you have a problem with that. Why don't you just tell me where Cinnamon is so you can go back to being a mockery
		of everything that is natural?\" Your eyes brighten as there is a fake breasts comment to be said, but "
		PM(Magnolia)

		" cuts you off.\n"

		"\"She's talking to Mr Kangaroo. If I didn't need this job so bad I'd smack that smirk off your face. Jerk. This is why nobody likes you.\""

		SetQuip(9,14,0)
		SetQuip(9,8,0)
		SetQuip(9,9,0)
	}

	case  9
	{
		Magnolia.karma += 1

		"\"What kind of mod? They make jerk mods these days? I should have kept up.\"\n"

		"\"They make 'mimes with acid tongues, evidently, so why not? But my girl was also killed the other night, when they got \ITaft.\i\"\n"

		"\"A tragedy. He was perfect as a Presidential candidate. Now he's perfect for banana bread.\"\n"

		"\"Ah!\" It had been years since you had thought of banana bread. It sounds delicious. \"Cinn was supposed to meet me here. I guess she had some
		information for me.\"\n"

		"\"She's with the boss in the office back there. It might be a while, you should probably just knock and barge in.\""

		SetQuip(9,14,0)
		SetQuip(9,8,0)
		SetQuip(9,9,0)
	}
   }


   case 10:
   {
   !Mr Chmod
   select(line)
	case 1: 
	{
		"\"Little,\" says Chmod. \"I've been here every night for the last two weeks, ever since I cashed out my Roth IRA.\"\n"
		"\"Whoa!\" you say. \"Hey, congratulations. I thought you were going to use that money to get off this moon, though? Why would you want to hang
		around the sphincter of the solar system for a second longer than you had to?\"\n"
		"\"Well, have you seen the new girls they've got working here? It changed everything. I can't leave. Not yet. It's very frustrating.\"\n"
		"\"Because you're a robot and they are cloned pantomimes of long-dead Earth girls, and how will they ever understand you, coming
		from such radically different worlds?\"\n"
		"\"No. \IBecause I haven't got a penis.\i\" Always an uncomfortable topic when broached, you stare at the ground for a few moments. 
		It still looks like gray sand. \"Besides,\" adds Chmod, \"this place only allows real girls.\""

		"\nThe doorman arrives from the north."
		move doorman to Corridor1

		SetQuip(10,1,0)
		SetQuip(10,2,0)
		SetQuip(10,3,0)

		SetQuip(10,4,1)
		SetQuip(10,5,1)
			
	}
	case 2:
	{
		"\"You've told me 23 times in the last 36 hours,\" says Mr Chmod. \"I can only assume this is big, as it beats your previous record for
		\Iannoying the living shit out of me\i, previously held by news that you shipped a trampoline.\"\n"
	
		"\"That was great fun. \IScarlett\i saw the top of the bubble and I got almost that far. You even set a high jump record, getting I think an 
		entire decameter off the ground, ha ha.\"\n"

		"Chmod's dull operating hum provides a few moments of contempt. He has mastered just the right length of pause to drop into cx before speaking
		to you.\n"

		"\"So... You're not going to tell me, are you?\" asks Chmod."
		"\nThe doorman arrives from the north."
		move doorman to Corridor1

		SetQuip(10,1,0)
		SetQuip(10,2,0)
		SetQuip(10,3,0)

		SetQuip(10,4,1)
		SetQuip(10,5,1)
		SetQuip(10,6,1)
	}

	case 3:
	{
		"\"It remains cramped,\" says Chmod. \"Why do you ask? It's just a place to hang my hat.\"\n"
		"\"Because I have it on good authority that you're going to get a lot more leg room shortly.\"\n"
		"Chmod's liquid attachment drops off his magnetic shelf, which we will pass off as his jaw dropping for our purposes here. 
		\"Is the moon breaking up? Great Scott! You're saying that Phobos is going to break up! I've heard the rumors, but never suspected 
		that --\"\n"
		"\"It's not completely verified, but I wouldn't play hard to get in there with any girl I've had my eye on if I were you, pal. 
		You're running out of time. Set those permissions to 777.\""

		"\nThe doorman arrives from the north."
		move doorman to Corridor1

		SetQuip(10,1,0)
		SetQuip(10,2,0)
		SetQuip(10,3,0)

		SetQuip(10,4,1)
		SetQuip(10,5,1)

	}
	case 4: 
	{
		"\"People and machines sometimes navigate Mars and its two moons through the use of keycards,\" says Chmod. \"Why don't you check to see
		if you have one for this club?\""

		SetQuip(10,4,0)
	}

	case 5:
	{
		"Chmod sighs. It comes out all fuzzy. \"He is the person who can let you into the club. That is his job. Give
		him your keycard. He keeps the riff-raff out.\"\n"
		"And it's true. When man colonized the Moon he sent his best engineers, technicians, pioneers and survivors. When
		he imprinted upon Mars, Titan and Ganymede he did the same. By the time the life bubble was ready on Phobos 
		mankind was really just looking for a place to dump its extra and unwanted pantomimes. An entire world filled to the brim with 
		poor copies of undesirables that nobody particularly cared for the first time around.\n"

		"With that much human garbage around there was a growing need for people to keep them out of places. This has worked reasonably
		well. You can't quite leave a fresh-baked apple pie out on your ledge, but you can put the trash out and expect to get your
		cans back."

		SetQuip(10,4,0)
		SetQuip(10,5,0)
	}

	case 6: 
	{
		"\"What? No!!\" Chmod looks around for a place to hide.\n"

		"\"Not now, dummy,\" you assure him. \"In a few months. Just don't go into one of those AI-killing
		logic loops and you're going to be all set. Plenty of time to get out.\"\n"

		"\"What AI-killing logic loop?\" asks Chmod. \"What are you even talking about.\" He mutters that
		last bit, statement more than question. \"Your girlfriend is waiting, endlessly, inside for you to make an
		honest woman out of her and put a ring on her finger and you're out here trying to freeze up a sneering
		vacuum cleaner.\" Chmod sneers.\n"

		"\"I mean, if God is all powerful, can he even create a rock that even he can't move?\"\n"

		"\"My latest firmware revision has a policy for people trying to trick us that way. I'm also supposed to warn you. When car thieves
		started throwing steaks at guard dogs, the tow truck industry developed the vegetarian pit bull that went into a blind rage when it 
		saw raw meat.\"\n"

		"\"Is that a threat? Asimov's three laws of robotics -- \"\n"

		"\"Are fiction,\" says Chmod, completing your sentence. \"Let's just get inside. You're going to be \Ithankful\i that I can let loose with a 
		Polish palm slap on people if the makeup if this crowd is typical.\""		

		SetQuip(10,6,0)
	}

	case 9:
	{
		"\"Just give the old man some scrip,\" says Chmod. \"Or wave your wallet around the room.\"\n"

		"\"Isn't that sort of obnoxious?\"\n"

		"\"Only to poor people. And I don't see any here.\"\n"

		"\"What about,\" you bring your voice down to a murmur, \"What about the old guy here?\"\n"

		"\"No,\" says Chmod, at normal volume, \"I \Iliterally can't see\i poor people. Ha ha, why waste the cycles, right?\""

		SetQuip(10,9,0)
	}

	case 7: 
	{
		move wallet to Raif

		"\"Oh, yeah... sorry, I'm a little distracted. You left it at my apartment last night.\" Mr Chmod opens up a small compartment 
		and hands you your wallet. \"Just show this to the old guy and we can get inside.\""

		SetQuip(10,7,0)
		SetQuip(10,9,0)
	}

	case 8:
	{
		"\"Why? Because of the low synchronous altitude of the moon you're currently on? That is keeping \Imy\i attention a mite
		bleary at the moment.\"\n"

		"\"I ... Chmod, I don't want to even know how much it cost to get in here. It cost so much that my wholly electronic wallet got lighter. I feel
		more lithe due to the number of bits gone from my account. It's impossible, but much like Phobos crashing, I know it's true.\"\n"

		"\"What?\" says a nearby nobody.\n"

		"\"I meant Deimos,\" you say. That seems to satisfy the nosy patron, as nobody cares about Deimos. In a sizeable solar system most people
		just can't generate the emotional cycles to give a crap about a 12 km by 15 km chunk of rock.\n"

		"\"Hey,\" says Chmod, \"Just relax and go over there and sit next to Scarlett. Take a load off and enjoy yourself.\""

		SetQuip(10,8,0)
	}

	case 10:
	{
		GameEvents[15] = 0

		"Chmod turns his head from side to side. He'd love to tell you but he can't stop his electric chortling.\n"

		"\"Did you... \Ihahahaha....\i did you see the pile of magazines upstairs? Ha haha haaa! Oh... Oh, the Maker... \IThe Maker!\i\"\n"

		if GameEvents[14] = 0
		{
			"\"What are you going on about? I have no idea. Is this a bit? Are you performing comic stylings on me? Is this a bit?\"\n"

			"\"No, not at all, man... not at all, Modern ChessMAN. BZZT BZZT BZZT!\" Chmod dissolves into more creepy robot laughter.\n"

			"But it all finally makes sense. A few months ago you were on the cover of Modern Chessman for the first championship match played by opponents on
			different worlds. You beat a Paki, David Rahman, who was in front of a dozen microphones and camera men, interrupted constantly. Your only distraction
			was \I\BJoe\i\b asking if we had either peanut butter or fluff once an hour. In the article you compared and contrasted the differences in locale, but
			honestly, though left unspoken, you believed that you won because without the prize money you'd have been broke and stranded here indefinitely."
		}
		else
		{
			GameEvents[14] = 1

			"\"Oh, no. You didn't read that, did you?\"\n"

			"\"I read it. I had to replace the LED in my eye. I shorted it with all the tears of laughter. You beat some guy in what was essentially 
			postal chess and somebody got paid to ask you questions about it. This is why we hate humans, by the way. \"\n"

			"\"Yeah, well, I sort of hate us, too. \" You look off to the side for effect. It snaps Chmod back into seriousness.\n"

			"\"Because of the, the death and -- \"\n"

			"\"No, because of the Chessman article, like you said.\""
		}

		SetQuip(10,10,0)
		
	}

	case 11: 
	{
		"\"Somebody cancelled the transport ship for robots. Naturally, I got curious. I'm really regretting spending all my money at
		the strip club, by the by. Anyway, when a covert decision to end all machine-based life is made I naturally look to the dollar
		signs and corpses. And wouldn't you know, a dead body that didn't make the news is here.\" Chmod's LED brightens 
		as he finishes his last sentence.\n"

		"\"Who is it?\"\n"

		"\"Guess.\""

		SetQuip(10,11,0)
		SetQuip(10,13,0)

		SetQuip(10,14,1)
		SetQuip(10,15,1)
		SetQuip(10,16,1)
		SetQuip(10,17,1)
	}

	case 14:
	{
		"\"What? No, it wasn't you.\""

		SetQuip(10,14,0)
	}

	case 15: 
	{
		"\"I don't think the man could even spell Phobos.\""

		SetQuip(10,15,0)
	}

	case 16: 
	{
		"\"It's plain to me that you're not taking this very seriously.\""

		SetQuip(10,16,0)
	}

	case 17:
	{
		"\"It was Mr Kangaroo's business partner. A human named Alexei.\"\n"

		"\"Does Alexei have a last name?\"\n"

		"\"Er... \" Chmod opens one of the corpse trays. He examines the toe tag on the body inside. \"Mitchell, it looks like. Alexei Mitchell. Never
		heard of him. I've never seen him around, either.\"\n"

		"\"At least he seems to be in a peaceful sleep,\" you say."

		GameEvents[21] = 1

		SetQuip(10,14,0)
		SetQuip(10,15,0)
		SetQuip(10,16,0)
		SetQuip(10,17,0)
		SetQuip(10,18,0)
	}
	case 18: 
	{
		"\"You name just about everyone before Chmod interrupts you.\n"

		"\"Why don't I just tell you? I had no idea you knew so many people. You always seem to be hanging around me, \B\IJoe\i\b and -- \"
		Chmod stops himself before he says '\IScarlett.\i.'\n"

		"\"Don't worry about it,\" you tell him. \"I'm just glad I got her to Earth so she didn't have to be laid to rest here.\"\n"

		"\"Grey always looked good on her, though.\" It appears as if Chmod is being sincere. \"The person that Mr Kangaroo was in business 
		with is the guy who ordered it. His name was Alexei. He's also now laying low here on a slab.\""

		GameEvents[21] = 1
		SetQuip(10,18,0)
	}

		
	case 12: 
	{
		"Chmod thinks about that for a little bit. When he's deep in thought he doesn't move and it looks like he locked up. \n"

		"\"Are you -- \"\n"

		"\"No,\" says Chmod, \"I'm fine. I wonder if it's related to the new corpse here. I thought guns were banned on Phobos.\"\n"

		"\"I got a trampoline delivered once. They don't check contraband very well.\"\n"

		"\"But a trampoline can't damage the bubble.\" Chmod isn't convinced.\n"

		"\"Yeah, but I \Ireally\i like trampolines. I could get high enough to almost touch the bubble.\"\n"

		"\"A trampoline's energy isn't affected by how happy the trampoliner is when using it. I think you've got a fundamental 
		schism with the Church of Isaac Newton.\"\n"

		"\"I'm just saying, is all. No matter what the job, people are eventually going to get bored by it. Even if it means that 
		the result of not checking contraband is a world with no atmosphere. Having your lungs implode and your skin boil away is a pie-in-the-sky,
		fantastic consequence to some people.\""

		SetQuip(10,12,0)
		GameEvents[20] = 1
	}

	case 13: 
	{
		"\"The shuttle that was supposed to take me and the other machines was \Icancelled.\i We have no official way off, 
		presently.\"\n"

		"\"That's -- what? They just cancelled it? Who cancelled it? And why?\"\n"

		"\"That's what I'm trying to find out... And my programming says follow the money and follow the bodies.\"\n"

		"\"An impressive theory. Is it working?\"\n"

		"\"I don't know, this is the first time I've ever been abandoned on an unfolding Martian rock donut.\""

		SetQuip(10,13,0)
		SetQuip(10,11,0)
		GameEvents[21] = 1
	}
	
	case 19
	{
		"\"Yeah,\" says Mr Chmod, \"Somebody took them. \IPretty freaking weird,\i isn't it? You can get replacement eyes at any
		Sunglasses Hut franchise. So I can only presume that the thief wasn't interested in them because they were eyes, but 
		because they were this guy's eyes.\"\n"

		"\"So there was probably a retinal scan that someone wanted to bypass.\"\n"

		"\"That's the most likely solution. Though it occurs to me, Raif, that I don't have the faintest idea of how retinal scanners actually
		work. Does the eye need to be living tissue? I'd look it up on the Internet, but they cut the signal to Earth.\"\n"
		
		"\"You're kidding me! We're stranded out here? In an information sense? What the hell! How will I check my investments?\"\n"

		"\"I didn't know you had -- \"\n"

		"\"But how would I check them?\""

		SetQuip(10,19,0)
	}

	case 20
	{
		!GameEvents[25] = Final conversation about Taft
		!GameEvents[26] = Final conversation about Alexei 

		"\"There are a lot of vague, ghost-like apparitions around Phobos. I only met your friend \B\IJoe\i\b two days ago when I went
		to your apartment, looking for you. Is he a little slow or something?\"\n"

		"\"He's a copy of a copy of a 20th Century baseball player. The original version is responsible for the most exciting play in the
		history of the World Series.\"\n"

		"\"The guy I met,\" says Chmod, \"Couldn't identify a single element in the \ILanthanide\i series.\" For mechanized people, that
		is a stinging criticism of mental agility, but it doesn't quite translate into Humanese. \"Where did you pick him up?\"\n"

		"\"He was wandering around the outskirts of the life bubble, homeless... he had no idea who he was. Normally I can't say I'd
		give a crap, but I recognized his giant-sized grin instantly. We're making progress, intellectually, with him. But your point
		about there being too many people on Phobos to completely memorize the populace is well taken, Chmod.\""

		SetQuip(10,20,0)
		GameEvents[26] = 1
	}

	case 21
	{
		"\"What makes you say that?\" asks Mr Chmod.\n"

		"\"The garish cut from septum to crotch, for starters.\"\n"
		
		"\"Well, the mortician tech was fired four months ago for an incident involving stored marrow. I have the newspapers of the time
		left in my cache and they actually sent up a specific shuttle from Earth to collect him. That's how crazy he was.\"\n"

		"\"Huh. \" You stare at \ITaft's\i remains a little longer. \"I'm no doctor, but he's obviously missing some parts. I don't know
		which, but the ribs have been sawed away, at least.\"\n"

		"\"Yeah. 'S wild. Maybe they did hire a new technician and I just don't have the info cached. Can't really tell with the Internet down.\""

		SetQuip(10,21,0)

		GameEvents[25] = 1
	}

	case 22:
	{
		"\"This guy, Alexei, was in business with Mr Kangaroo. Have you looked at his eyes yet?\" asks Chmod.\n"

		if GameEvents[23] = 0
		{
			"\"No.\" \n"

			"\"You should,\" he says, his expression dead vacant."
		}
		else
		{
			"\"Yes.\"\n"

			"\"Oh! Sorry, then -- I didn't mean to be condescending. I just know that his death was completely covered up. There isn't a word
			of it in the news cache I have locally. Alexei here was in business with Mr Kangaroo.\""

			GameEvents[26] = 1
		}

		SetQuip(10,22,0)
	}

	case 24:
	{
		"\"He's relentless, this machine, this Mr Kangaroo,\" says Chmod. \"Just stop him. I can be repaired!\""
		SetQuip(10,24,0)
	}

	case 25: 
	{
		"\"I ache everywhere,\" he says. \"What happened?\"\n"
		"\"We're gonna be okay. I promise...\" You try to pick him up, but he's surprisingly heavy. \"I'll get you off this moon, okay? I will get you
		out of here!\""

		SetQuip(10,25,0)
	}

   }


   case 11:
   {
   !old soul 
   select(line)
	case 1: 
	{
		"\"You get old as me, you stop rememberrin...\" he says. \"Ida know, bad credit risk I guess, why else I here?\""

		SetQuip(11,1,0)
		SetQuip(11,3,0)
	}

	case 2: 
	{
		if wallet not in Raif
		{
			if GameEvents[5] = 0
			{
				GameEvents[5] = 1
				SetQuip(10,7,1)
			}
				"The old soul looks at his monitor and frowns. Well, frowns further. 
				\"You got no money. No money no membership, dat's how it works.\""

				SetQuip(10,9,0)
		}
		else
		{
			SetQuip(11,2,0)
			"\"Yeah, yeah, we all gotta eat.\"\n"
			"The old guy isn't speaking a localized dialect; you really have no idea what he's talking about.\n"
			"\"Money deducted wirelessly from your account! You go in!\""

			GameEvents[6] = 1
		}
	}

	case 3: 
	{
		SetQuip(11,3,0)
		"\"I invite you to cram it.\""
	}

	}

   case 13:
   {
   !Mr Kangaroo
   select(line)
	case 1:
	{
		Cinnamon.karma -= 3
		Kangaroo.karma += 1
		GameEvents[28] = 1

		"\"Really? And who might that be?\" Kangaroo is sort of interested and sort of surprised that you actually interrupted his meeting.\n"

		"\"";
		PM(Magnolia)
		",\" you say. \"I recently took some code that allowed me to distinguish between pantomimes and regular people. She was the first one that came up
		positive. I thought you'd want to know, what with your reputation and everything.\" Cinnamon runs through a gauntlet of expressions but remains
		silent.\n"

		"\"Thank you for the information,\" says Kangaroo. \"I'll certainly look into it... Hmm.\" He gives the matter a little thought, but turns his attention
		back to the stunning redhead in the room with him."

		SetQuip(13,1,0)
	
	}

	case 2:
	{
		Cinnamon.karma += 1

		"\"'Till the end of the world!\" exclaims Kangaroo. He then ruins it by laughing for too long at his own joke. You give a raised eyebrow to Cinnamon,
		hoping that she can clear things up. All you get is upturned palms, however.\n"

		"\"She will be finished in just a few moments,\" says Kangaroo, \"We're just sorting things out for our future. Cinn, why don't you meet the young man
		someplace?\"\n"

		"Cinnamon quickly nods her head and turns back to you. \"Meet me at the diner in a little bit. It will be great to finally chat with you!\" The last part was
		fake, but you get the impression that it's necessary for her meeting to continue to go smoothly."

		SetQuip(13,1,0)
		SetQuip(13,2,0)
		SetQuip(13,3,0)
		SetQuip(6,1,0)
		SetQuip(6,2,0)
		SetQuip(6,3,0)

		GameEvents[13] = 1 ! through with Cinnamon 
		

	}

	case 3:
	{
		"\"Well, you're a polite young man, aren't you? Say... \" Kangaroo gives you a closer look. \"I recognize you... you're the poor chap whose wife died in my
		club, aren't you? God, man! What are you doing back here?\"\n"

		"\"She wasn't my wife. The real tragedy that night was the death of \ITaft\i, anyway, sir. What with the muck-up raising Lincoln and all. Who does
		that party have left,  Harding? The sentient spirit of America already killed him once through his weak heart. I bet \IHarding\i doesn't make
		it out of the vats.\"\n"

		"Kangaroo looks at you like you just ate the last dodo, didn't bother to finish it, and used one of its feathers as a quill to give its taste a negative
		review.\n"

		"\"Why don't we meet up at the diner in a little bit?\" suggests Cinnamon."

		SetQuip(13,1,0)
		SetQuip(13,2,0)
		SetQuip(13,3,0)

		SetQuip(6,1,0)
		SetQuip(6,2,0)
		SetQuip(6,3,0)

		GameEvents[13] = 1 ! through with Cinnamon 

	}

	case 4: 
	{
		"\"Shut the fuck up!\" yells Kangaroo. \"Die with dignity!\""

		SetQuip(13,4,0)
	}


   }

 case 15: 
   {
   !Ms Kitler
   select(line)
	case 1: 
	{
		
		"\"Yes... Raif... One call here... for you...\" Ms Kitler did not get a particularly human voice installed, and instead sounds sad and metallic as she struggles
		to parse and answer your questions. \"Cinnamon said... she would be late... but she will... meet you here... as soon as she can...\""

		SetQuip(15,1,0)
	}

	case 2:
	{
		"\"What... kind of sandwich... would you -- \"\n"
		"\"I'm just kidding, Ms. Kitler. This place is in my top ten list for reasons to leave Phobos. I don't want any food.\"\n"
		"\"We... have a special on... \" You think about cutting her off again, but it just seems so damned pathetic. You let her list
		off the specials. They sound increasingly repugnant. True artistry, total command of the flow of language went into the 
		description of those specials. This place really is completely inoffensive and only slightly \Itriste\i towards four of 
		your five major senses."

		SetQuip(15,2,0)
	}

	case 3: 
	{
		"\"No... Raif... it is mine to simply serve... at this place...\"\n"
		"\"That's horrible. I wouldn't wish that on any one. \"\n"
		"\"Would you like... to hear... the specials?\"\n"
		"\"That's another thing I wouldn't wish on anyone, ma'am.\""

		SetQuip(15,3,0)
	}
   }	
   
   case 16: 
     {
     !The Sun
     select(line)
	case 1: 
	{
		"I always had faith in you, Raif. So few people talk to me these days... fewer still even listen. I used to be worshiped, you know. 
		I can't blame people too much. Just looking at me from Earth causes blindness."

		SetQuip(16,1,0)
		SetQuip(16,2,0)
		SetQuip(16,3,1)
		SetQuip(16,4,1)
	}

	case 2: 
	{
		"I am the very center of our solar system. A brilliant yellow jewel, anchoring 11 planets, countless asteroids, Kuiper belt
		objects, but admittedly not moons, usually. I am the person who has been talking to you all this time. I am Sol. I am
		the Sun."

		SetQuip(16,1,0)
		SetQuip(16,2,0)
		SetQuip(16,3,1)
		SetQuip(16,4,1)
	}

	case 3: 
	{
		"It's not all that odd, is it? People have talked to unseemly things for centuries. Is it any more crazy to speak to the Sun -- someone real, someone
		who impacts your life in a very real and applicable way -- than long dead prophets, invisible revenants of creation myth or even more hilariously,
		other drivers in freeway traffic?"

		SetQuip(16,3,0)
		SetQuip(16,4,0)
		SetQuip(16,5,1)
	}

	case 4: 
	{
		"I don't think so, Raif. But there are some definitions you may want to wrestle with... er... I may not be the best person to ask. But is it any crazier
		than those who talk to the dead? I'm here for you, my child. You can see me every single day, from as close as the planet inside the orbit of Mercury,
		to the distant world beyond Pluto. Is it crazy to talk to me, Raif? I've been here for over four billion years. I personally think its crazier to converse with invisible prophets,
		the 'soul' of the Earth itself or customer service representatives billing you for pornography each month.\n"

		"...\n"
		
		"... Sorry. You probably didn't want that getting out."

		SetQuip(16,3,0)
		SetQuip(16,4,0)
		SetQuip(16,5,1)
	}

	case 5:
	{
		"Well, I anticipated this, Raif. It takes twelve minutes for my light to reach you. I personally like to think that when I create an electromagnetic pulse that
		will rip through tin like it was a single-layer Kleenex it gets there faster, but I understand that it just seems that way. I don't often get to let loose like this. 
		Let me tell you what we used to do to tin in the old days... we'd vaporize it just because it was there. We'd ionize it into elements with atomic numbers 
		so low and common that the discoverers of such atoms are all named 'Thrakack' and 'Aaaaargh.' \n"

		"Anyway. Hold tight. In a couple minutes that panel won't be giving you any more trouble."

		Activate(Panel_Breaks)

		SetQuip(16,5,0)
	}

	case 6:
	{
		"Phobos is an odd duck, you know. As I understand it, due to the fact that it's below the Roche limit, the tides have 
		more of an effect on the surface than its own, meager gravity.
		Of course, men installed a gravity generator... only, it wasn't all that good. Or powerful. Try picking up the boulder, Raif. I know there's no room to push it, but I bet you can lift it
		and toss it away. "

		SetQuip(15,6,0)
	}

	case 7: 
	{
		"You take care of yourself and that girl, Raif. Don't be a stranger. I'll have my eye on you!"
		SetQuip(15,7,0)
	}
   }! the Sun
   
}


routine Reset_Quips
{

! Scarlett2
SetQuip(2,1,1)
SetQuip(2,2,1)

! Chmod
SetQuip(10,1,1)
SetQuip(10,2,1)
SetQuip(10,3,1)

! Doorman
SetQuip(7,1,1)
SetQuip(7,2,1)
SetQuip(7,3,1)

! Magnolia
!SetQuip(9,1,1)
!SetQuip(9,2,1)
SetQuip(9,3,1)
SetQuip(9,4,1)
SetQuip(9,5,1)
!SetQuip(9,6,1)

! Old Soul
SetQuip(11,1,1)
SetQuip(11,2,1)
SetQuip(11,3,1)

! Kangaroo
SetQuip(13,2,1)
SetQuip(13,3,1)

!Ms Kitler
SetQuip(15,1,1)
SetQuip(15,2,1)
SetQuip(15,3,1)
}


routine Switch_Chapter(ChapNum)
{
local i, c, j 

Chapter = ChapNum

select(ChapNum)

	case 2:
		{
			"\n"

			pause


			! for demo
		
                       for i in player
                        {
                                c++
                        }

                        if c ~= 0
                        {
                           while c > 0
                                {
                                    for i in player
                                    {
	                                    j = i

                                    }

                                    remove j 
                                    c--
				}
			}

			for i in Raif
			{
				!print i.name
				remove i

			}

		move Joe to couch01
		phone is special

		PhoneArray[1] = 1

		MoveOnto(desk01, phone)

		move Kangaroo to StripOffice01
		move Cinnamon to StripOffice01
		! Cinnamon 
		SetQuip(6,1,1)
		SetQuip(6,2,1)
		SetQuip(6,3,1)

		move Chmod to Morgue03
		! Mr Chmod
		SetQuip(10,1,0)
		SetQuip(10,2,0)
		SetQuip(10,3,0)
		SetQuip(10,4,0)
		SetQuip(10,5,0)
		SetQuip(10,6,0)
		SetQuip(10,7,0)
		SetQuip(10,8,0)
		SetQuip(10,9,0)
		SetQuip(10,10,1)
		SetQuip(10,11,1)
		SetQuip(10,12,1)
		SetQuip(10,13,1)

		move Taft to Slab02
		Taft.hitpoints = -101
		Taft is not hidden

	        BGCOLOR = BLACK
		color TEXTCOLOR, BGCOLOR

		cls

		counter 	= 0

		MovePlayer(FakeRoom1)
		Run_Flashback()

		counter 	= 804

		! remove this for bug testing
		!endflag = 1 

		BGCOLOR = DARK_GRAY
		color TEXTCOLOR, BGCOLOR

		cls

		MovePlayer(Office)

		}  ! case 2

	case 3:
		{
			"\n"

			pause

		        BGCOLOR = BLACK
			color TEXTCOLOR, BGCOLOR

			cls

			old_counter = counter
			counter 	= 0

			MovePlayer(FakeRoom1)
			Run_Flashback()

			counter = old_counter		

			BGCOLOR = DARK_GRAY
			color TEXTCOLOR, BGCOLOR

			cls

		} ! case 3

	case 4:
		{
			"\n"

			pause

		        BGCOLOR = BLACK
			color TEXTCOLOR, BGCOLOR

			cls

			old_counter = counter
			counter 	= 0

			MovePlayer(FakeRoom2)
			Run_Flashback()

			BGCOLOR = DARK_GRAY
			color TEXTCOLOR, BGCOLOR

			cls

		} ! case 4

	case 5:
		{
			"\n"

			pause

		        BGCOLOR = BLACK
			color TEXTCOLOR, BGCOLOR

			cls

			old_counter = counter
			counter 	= 0

			!The Sun
			SetQuip(16,1,1)
			SetQuip(16,2,1)

			MovePlayer(FakeRoom3)
			Run_Flashback()

			counter = old_counter		
			counter += 30

			if counter > 1400
			{
				counter = 5
			}		

			BGCOLOR = DARK_GRAY
			color TEXTCOLOR, BGCOLOR

			cls

			MovePlayer(Airlock)

			! Turn off the Chmod giggling thing
			GameEvents[15] = 0
		} ! case 5

}
	